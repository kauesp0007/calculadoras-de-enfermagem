<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preload" href="/menu-global.html" as="fetch" crossorigin>
    <link rel="preload" href="/global-body-elements.html" as="fetch" crossorigin>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <base href="https://www.calculadorasdeenfermagem.com.br/">
    <title>Gerador de Apresentação Institucional | Calculadoras de Enfermagem</title>
    <meta name="robots" content="noindex, nofollow">
    <meta name="description" content="Crie e personalize apresentações institucionais sobre a Calculadoras de Enfermagem para compartilhar em redes sociais.">
    <link rel="canonical" href="https://www.calculadorasdeenfermagem.com.br/institucional/institucional.html">
    <link rel="icon" href="images/favicon.png" type="image/png">
    
    <!-- Scripts e Estilos Globais do Site -->
    <script src="https://cdn.tailwindcss.com" defer></script>
    <link rel="stylesheet" href="global-styles.css" media="print" onload="this.media='all'">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" media="print" onload="this.media='all'">
    
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Nunito+Sans:wght@700;800;900&display=swap&display=swap" rel="stylesheet">

    <!-- Scripts Específicos da Ferramenta -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    
    <style>
        /* Estilos Globais e Variáveis CSS */
        :root {
            --primary-color: #1a3e74;
            --primary-light: #2a5a94;
            --secondary-color: #10B981;
            --white: #ffffff;
            --text-dark: #1f2937;
            --text-light: #f9fafb;
            --text-color: #2c2c2c;
            --shadow: 0 4px 20px rgba(26, 62, 116, 0.1);
            --border-radius: 12px;
            --bg-light: #f8f9fa;
        }
        #global-header-container .max-w-7xl, footer .max-w-7xl { max-width: 1600px !important; }
        
        /* Ajuste para o container principal da ferramenta */
        .main-container-wrapper {
            margin-top: 85px;
            padding: 0; 
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-light);
            color: var(--text-color);
        }
        /* Layout Principal */
        .main-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
            min-height: calc(100vh - 85px);
            gap: 1.5rem;
            padding: 1.5rem;
        }
        /* Painel de Edição */
        .editor-panel {
            width: 100%;
            max-width: 420px;
            background: var(--white);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
            align-self: flex-start;
        }
        /* Visualizador da Apresentação */
        .presentation-viewer {
            flex: 1; 
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            width: 100%;
        }
        /* Responsividade */
        @media (min-width: 1024px) {
            .main-container { flex-direction: row; align-items: flex-start; justify-content: center; }
            .editor-panel { flex-shrink: 0; }
        }
        @media (max-width: 1024px) { .editor-panel { max-width: 600px; } }

        /* Estilos do Editor */
        .editable { outline: none; }
        .editable:hover, .editable:focus { 
            box-shadow: 0 0 0 2px var(--primary-color); 
            background-color: rgba(26, 62, 116, 0.1); 
            border-radius: 4px;
        }
        .tab-buttons { display: flex; border-bottom: 1px solid #e5e7eb; margin-bottom: 1.5rem; flex-wrap: wrap; }
        .tab-button { padding: 0.75rem 1rem; font-size: 0.875rem; font-weight: 600; cursor: pointer; border-bottom: 2px solid transparent; transition: all 0.2s ease; color: #6b7280; }
        .tab-button:hover { color: var(--primary-color); }
        .tab-button.active { color: var(--primary-color); border-bottom-color: var(--primary-color); }
        .tab-content { display: none; }
        .tab-content.active { display: block; animation: fadeIn 0.5s; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .control-section { margin-bottom: 1.5rem; }
        .control-label { display: block; font-size: 0.875rem; font-weight: 600; color: #4b5563; margin-bottom: 0.75rem; }
        .btn-control { padding: 0.5rem; border-radius: 0.5rem; transition: all 0.2s ease; cursor: pointer; border: 1px solid #e5e7eb; background-color: #f9fafb; font-size: 0.875rem; }
        .btn-control:hover { background-color: #f3f4f6; border-color: #d1d5db; }
        .btn-control:disabled { opacity: 0.5; cursor: not-allowed; }
        .btn-control.active { background-color: var(--primary-color); color: var(--white); border-color: var(--primary-color); }
        .btn-primary { background-color: var(--primary-color); color: var(--white); padding: 0.75rem 1rem; border-radius: 0.5rem; transition: all 0.3s ease; box-shadow: 0 4px 10px rgba(0,0,0,0.1); font-weight: 600; text-align: center; }
        .btn-primary:hover { background-color: var(--primary-light); transform: translateY(-2px); box-shadow: 0 6px 15px rgba(0,0,0,0.15); }
        .logo-choice { padding: 0.5rem; border: 2px solid #e5e7eb; border-radius: 0.5rem; cursor: pointer; transition: all 0.2s ease; }
        .logo-choice:hover, .logo-choice.selected { border-color: var(--primary-color); transform: scale(1.05); }
        .logo-choice img { height: 40px; width: 100%; object-fit: contain; }
        .switch { position: relative; display: inline-block; width: 38px; height: 22px; }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; border-radius: 22px; }
        .slider:before { position: absolute; content: ""; height: 16px; width: 16px; left: 3px; bottom: 3px; background-color: white; transition: .4s; border-radius: 50%; }
        input:checked + .slider { background-color: var(--primary-color); }
        input:checked + .slider:before { transform: translateX(16px); }

        /* Estilos da Apresentação */
        .slide-container {
            width: 500px;
            height: 500px;
            box-shadow: var(--shadow);
            border-radius: var(--border-radius);
            overflow: hidden;
            position: relative;
            transition: width 0.3s ease, height 0.3s ease;
        }
        #slider { transition: transform 0.5s ease-in-out; }
        .slide {
            flex-shrink: 0;
            background-color: white;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            position: relative;
            overflow: hidden;
        }
        .slide-content-wrapper {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 2rem;
            transition: transform 0.3s ease;
            transform-origin: center center;
        }
        .brand-logo {
            width: 80px;
            height: 80px;
            background-color: var(--primary-color);
            color: white;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: 'Nunito Sans', sans-serif;
            font-weight: 900;
            font-size: 2.5rem;
        }
        .nav-button {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background-color: rgba(26, 62, 116, 0.8);
            color: white;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            cursor: pointer;
            z-index: 10;
            transition: background-color 0.2s;
        }
        .nav-button:hover { background-color: var(--primary-color); }
        #prev { left: 1rem; }
        #next { right: 1rem; }
        #progress-bar-container {
            width: 500px;
            max-width: 100%;
            background-color: #e5e7eb;
            border-radius: 99px;
            margin-top: 1rem;
            transition: width 0.3s ease;
        }
        #progress-bar {
            height: 8px;
            background-color: var(--primary-color);
            border-radius: 99px;
            width: 0%;
            transition: width 0.5s ease-in-out;
        }
        .animated-counter {
            font-family: 'Nunito Sans', sans-serif;
            font-weight: 900;
            color: var(--primary-color);
        }

        /* Imagem Editável */
        .editable-image-container {
            position: relative;
            cursor: pointer;
            overflow: hidden;
        }
        .editable-image-container::after {
            content: '\f040'; /* Font Awesome pencil icon */
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            background-color: rgba(0,0,0,0.5);
            padding: 1rem;
            border-radius: 50%;
            opacity: 0;
            transition: opacity 0.2s ease;
        }
        .editable-image-container:hover::after {
            opacity: 1;
        }

        /* Overlay de Carregamento */
        #loading-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: rgba(0,0,0,0.7);
            display: none;
            flex-direction: column; justify-content: center; align-items: center;
            z-index: 9999; color: white;
        }
        #loading-overlay.is-visible { display: flex; }
        #loading-overlay .fa-spinner { font-size: 3rem; }
        #loading-overlay p { margin-top: 1rem; font-size: 1.1rem; }
    </style>
</head>
<body style="display: none;">
    <div id="global-header-container"></div>
<div id="language-dropdown-wrapper" class="flex justify-end w-full" style="position:relative; z-index:100; padding-right:2rem;">
  <div class="relative inline-block text-left z-50">
    <button id="langButton" class="flex items-center space-x-2 border px-3 py-1 rounded-lg shadow bg-gray-100">
      <img id="langFlag" width="20" height="16" src="bandeira-brasil.webp" alt="BR" class="w-5 h-4 rounded-sm">
      <span id="langText" class="text-gray-700 font-medium">Português</span>
      <svg class="w-4 h-4 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
      </svg>
    </button>

    <div id="langMenu" class="hidden absolute right-0 mt-2 w-44 bg-white border rounded-lg shadow-lg">
      <div class="flex items-center px-3 py-2 hover:bg-gray-100 cursor-pointer space-x-2" data-value="pt" data-flag="bandeira-brasil.webp">
        <img src="bandeira-brasil.webp" class="w-5 h-4 rounded-sm" alt="BR" width="20" height="16"><span>Português</span>
      </div>
      <div class="flex items-center px-3 py-2 hover:bg-gray-100 cursor-pointer space-x-2" data-value="en" data-flag="bandeira-eua.webp">
        <img src="bandeira-eua.webp" class="w-5 h-4 rounded-sm" alt="EN" width="20" height="16"><span>English</span>
      </div>
      <div class="flex items-center px-3 py-2 hover:bg-gray-100 cursor-pointer space-x-2" data-value="es" data-flag="bandeira-espanha.webp">
        <img src="bandeira-espanha.webp" class="w-5 h-4 rounded-sm" alt="ES" width="20" height="16"><span>Español</span>
      </div>
      <div class="flex items-center px-3 py-2 hover:bg-gray-100 cursor-pointer space-x-2" data-value="de" data-flag="bandeira-alemanha.webp">
        <img src="bandeira-alemanha.webp" class="w-5 h-4 rounded-sm" alt="DE" width="20" height="16"><span>Deutsch</span>
      </div>
      <div class="flex items-center px-3 py-2 hover:bg-gray-100 cursor-pointer space-x-2" data-value="it" data-flag="bandeira-italia.webp">
        <img src="bandeira-italia.webp" class="w-5 h-4 rounded-sm" alt="IT" width="20" height="16"><span>Italiano</span>
      </div>
      <div class="flex items-center px-3 py-2 hover:bg-gray-100 cursor-pointer space-x-2" data-value="fr" data-flag="bandeira-franca.webp">
        <img src="bandeira-franca.webp" class="w-5 h-4 rounded-sm" alt="FR" width="20" height="16"><span>Français</span>
      </div>
      <div class="flex items-center px-3 py-2 hover:bg-gray-100 cursor-pointer space-x-2" data-value="fr" data-flag="bandeira-franca.webp">
        <img src="bandeira-india.webp" class="w-5 h-4 rounded-sm" alt="HI" width="20" height="16"><span>भारत</span>
      </div>
      <div class="flex items-center px-3 py-2 hover:bg-gray-100 cursor-pointer space-x-2" data-value="fr" data-flag="bandeira-franca.webp">
        <img src="bandeira-china.webp" class="w-5 h-4 rounded-sm" alt="CN" width="20" height="16"><span>中国</span>
      </div>
      <div class="flex items-center px-3 py-2 hover:bg-gray-100 cursor-pointer space-x-2" data-value="fr" data-flag="bandeira-franca.webp">
        <img src="bandeira-arabia.webp" class="w-5 h-4 rounded-sm" alt="AR" width="20" height="16"><span>اللغة العربية</span>
      </div>
      <div class="flex items-center px-3 py-2 hover:bg-gray-100 cursor-pointer space-x-2" data-value="fr" data-flag="bandeira-franca.webp">
        <img src="bandeira-japao.webp" class="w-5 h-4 rounded-sm" alt="JP" width="20" height="16"><span>日本語</span>
      </div>
    </div>
  </div>
</div><main class="main-container-wrapper">
        <input type="file" id="image-upload-input" class="hidden" accept="image/*">
        <div id="loading-overlay">
            <i class="fas fa-spinner fa-spin"></i>
            <p>Exportando slides...</p>
        </div>

        <div class="main-container">
            <!-- PAINEL DE EDIÇÃO -->
            <div class="editor-panel">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-2xl font-bold text-gray-800">Editor</h2>
                    <div class="flex gap-2">
                        <button id="undo-btn" onclick="undo()" class="btn-control" title="Desfazer (Ctrl+Z)"><i class="fas fa-undo"></i></button>
                        <button id="redo-btn" onclick="redo()" class="btn-control" title="Refazer (Ctrl+Y)"><i class="fas fa-redo"></i></button>
                    </div>
                </div>
                <p class="text-sm text-gray-500 mb-6">Use as opções para configurar.</p>

                <div class="tab-buttons">
                    <button class="tab-button active" onclick="openTab(event, 'tab-geral')">Geral</button>
                    <button class="tab-button" onclick="openTab(event, 'tab-layout')">Layout</button>
                    <button class="tab-button" onclick="openTab(event, 'tab-logo')">Logo</button>
                    <button class="tab-button" onclick="openTab(event, 'tab-texto')">Texto</button>
                    <button class="tab-button" onclick="openTab(event, 'tab-export')">Exportar</button>
                </div>

                <div id="tab-geral" class="tab-content active">
                    <div class="control-section">
                        <label class="control-label">Modelos Predefinidos</label>
                        <div class="grid grid-cols-2 gap-2">
                            <button onclick="applyTemplate('classic')" class="btn-control">Clássico</button>
                            <button onclick="applyTemplate('corporate')" class="btn-control">Corporativo</button>
                            <button onclick="applyTemplate('modern')" class="btn-control">Moderno</button>
                            <button onclick="applyTemplate('fresh')" class="btn-control">Fresco</button>
                        </div>
                    </div>
                    <div class="control-section">
                        <label class="control-label">Cores</label>
                         <div class="flex items-center justify-between mb-2">
                            <span>Cor Primária</span>
                            <input type="color" id="primaryColorPicker" value="#1a3e74" class="w-8 h-8 rounded-full border-none cursor-pointer">
                        </div>
                    </div>
                </div>

                <div id="tab-layout" class="tab-content">
                     <div class="control-section">
                        <label class="control-label">Formato da Apresentação</label>
                        <div class="grid grid-cols-3 gap-2">
                            <button onclick="resizePresentation('square', this)" class="btn-control active">Quadrado</button>
                            <button onclick="resizePresentation('portrait', this)" class="btn-control">Retrato</button>
                            <button onclick="resizePresentation('stories', this)" class="btn-control">Stories</button>
                        </div>
                    </div>
                     <div class="control-section space-y-3">
                        <label class="control-label">Visibilidade dos Elementos</label>
                        <div class="flex items-center justify-between"><span class="text-sm">Mostrar Logo</span><label class="switch"><input type="checkbox" id="toggleLogo" onchange="updateAndSaveState()"><span class="slider"></span></label></div>
                        <div class="flex items-center justify-between"><span class="text-sm">Mostrar Rodapé</span><label class="switch"><input type="checkbox" id="toggleFooter" onchange="updateAndSaveState()" checked><span class="slider"></span></label></div>
                    </div>
                </div>

                <div id="tab-logo" class="tab-content">
                    <div class="control-section">
                        <label class="control-label">Posição do Logo</label>
                        <div class="grid grid-cols-2 gap-2">
                            <button onclick="setLogoPosition('header', this)" class="btn-control active">Cabeçalho</button>
                            <button onclick="setLogoPosition('footer', this)" class="btn-control">Rodapé</button>
                        </div>
                    </div>
                    <div class="control-section">
                        <label class="control-label">Layout do Cabeçalho</label>
                        <div class="grid grid-cols-2 gap-2">
                            <button onclick="setHeaderLayout('logo-left', this)" class="btn-control active">Logo Esquerda</button>
                            <button onclick="setHeaderLayout('logo-right', this)" class="btn-control">Logo Direita</button>
                        </div>
                    </div>
                     <div class="control-section">
                        <label class="control-label">Layout do Rodapé</label>
                        <div class="grid grid-cols-2 gap-2">
                            <button onclick="setFooterLayout('logo-left', this)" class="btn-control active">Logo Esquerda</button>
                            <button onclick="setFooterLayout('logo-right', this)" class="btn-control">Logo Direita</button>
                        </div>
                    </div>
                    <div class="control-section">
                        <label class="control-label">Selecionar Logo</label>
                        <div id="logo-selection" class="grid grid-cols-3 gap-2">
                            <div class="logo-choice" onclick="selectLogo('https://www.calculadorasdeenfermagem.com.br/icontopbar1.webp', this)"><img src="https://www.calculadorasdeenfermagem.com.br/icontopbar1.webp" alt="Logo 1"></div>
                            <div class="logo-choice" onclick="selectLogo('https://www.calculadorasdeenfermagem.com.br/iconpages.webp', this)"><img src="https://www.calculadorasdeenfermagem.com.br/iconpages.webp" alt="Logo 2" width="128" height="192"></div>
                        </div>
                    </div>
                </div>
                
                <div id="tab-texto" class="tab-content">
                    <div class="control-section">
                        <label class="control-label">Cabeçalho e Fundo Colorido</label>
                        <div class="flex items-center justify-between mb-2">
                            <span>Cor do Título</span>
                            <input type="color" id="headerTitleColorPicker" value="#ffffff" class="w-8 h-8 rounded-full border-none cursor-pointer">
                        </div>
                         <div class="flex items-center justify-between">
                            <span>Cor do Subtítulo</span>
                            <input type="color" id="headerSubtitleColorPicker" value="#ffffff" class="w-8 h-8 rounded-full border-none cursor-pointer">
                        </div>
                    </div>
                     <div class="control-section">
                        <label class="control-label">Corpo do Texto (Fundo Branco)</label>
                        <div class="flex items-center justify-between mb-2">
                            <span>Cor do Texto Geral</span>
                            <input type="color" id="bodyTextColorPicker" value="#1f2937" class="w-8 h-8 rounded-full border-none cursor-pointer">
                        </div>
                    </div>
                </div>

                <div id="tab-export" class="tab-content">
                     <div class="control-section space-y-3">
                        <button onclick="exportSingleSlide()" class="w-full btn-primary">Exportar Slide Atual</button>
                        <button onclick="exportAllSlides()" class="w-full btn-primary bg-green-600 hover:bg-green-700">Exportar Todos (.zip)</button>
                    </div>
                </div>
            </div>

            <!-- VISUALIZADOR DA APRESENTAÇÃO -->
            <div class="presentation-viewer">
                <div id="presentation-container" class="relative">
                    <div class="slide-container overflow-hidden bg-white mx-auto">
                        <div id="slider" class="w-full h-full flex">
                            
                            <!-- Slide 1: Capa -->
                            <div class="slide w-full h-full" style="background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-light) 100%);">
                                <div class="slide-content-wrapper">
                                    <div class="brand-logo bg-white text-primary-color mb-6 shadow-lg">+</div>
                                    <h1 contenteditable="true" class="editable text-5xl font-extrabold text-center text-white" style="font-family: 'Nunito Sans', sans-serif;">Calculadoras de Enfermagem</h1>
                                    <p contenteditable="true" class="editable text-2xl text-center text-white/90 mt-4">Inovação e Cuidado na Palma da Mão</p>
                                    <div class="absolute bottom-4 text-white/80 text-sm"><span contenteditable="true" class="editable">www.calculadorasdeenfermagem.com.br</span></div>
                                </div>
                            </div>

                            <!-- Slide 2: Criado por -->
                            <div class="slide w-full h-full">
                                <div class="slide-content-wrapper">
                                    <h2 contenteditable="true" class="editable text-4xl font-bold text-gray-800 text-center mb-8">Criado por Enfermeiros, para a Enfermagem</h2>
                                    <div class="flex items-center gap-16 w-full">
                                        <div class="w-1/3 editable-image-container rounded-full"><img src="https://placehold.co/400x400/1a3e74/ffffff?text=Creator" alt="Foto do criador" class="rounded-full shadow-2xl w-full h-full object-cover"></div>
                                        <div class="w-2/3 text-lg text-gray-700 space-y-4">
                                            <div class="flex items-start gap-4"><i class="fa-solid fa-user-nurse text-2xl text-primary-color mt-1"></i><span contenteditable="true" class="editable">Profissional com mais de <strong>10 anos de experiência</strong> em assistência e gestão.</span></div>
                                            <div class="flex items-start gap-4"><i class="fa-solid fa-lightbulb text-2xl text-primary-color mt-1"></i><span contenteditable="true" class="editable">Idealizado a partir da <strong>necessidade real</strong> de otimizar o tempo e aumentar a segurança do paciente.</span></div>
                                            <div class="flex items-start gap-4"><i class="fa-solid fa-laptop-code text-2xl text-primary-color mt-1"></i><span contenteditable="true" class="editable">Desenvolvido com paixão por tecnologia e um profundo <strong>respeito pela profissão</strong>.</span></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Slide 3: Missão, Visão e Valores -->
                            <div class="slide w-full h-full">
                                 <div class="slide-content-wrapper">
                                    <h2 contenteditable="true" class="editable text-4xl font-bold text-gray-800 mb-12 text-center">Nossa Essência</h2>
                                    <div class="grid grid-cols-3 gap-8 text-left w-full">
                                        <div class="p-6 bg-gray-50 rounded-lg">
                                            <h3 contenteditable="true" class="editable text-2xl font-bold text-primary-color mb-3">Missão</h3>
                                            <p contenteditable="true" class="editable text-gray-600">Empoderar profissionais e estudantes de enfermagem com ferramentas digitais precisas, gratuitas e de fácil acesso, transformando a prática clínica.</p>
                                        </div>
                                        <div class="p-6 bg-gray-50 rounded-lg">
                                            <h3 contenteditable="true" class="editable text-2xl font-bold text-primary-color mb-3">Visão</h3>
                                            <p contenteditable="true" class="editable text-gray-600">Ser a principal plataforma de referência em ferramentas e conteúdo para a enfermagem na América Latina, impulsionando a excelência no cuidado.</p>
                                        </div>
                                        <div class="p-6 bg-gray-50 rounded-lg">
                                            <h3 contenteditable="true" class="editable text-2xl font-bold text-primary-color mb-3">Valores</h3>
                                            <p contenteditable="true" class="editable text-gray-600"><i class="fas fa-check-circle text-secondary-color"></i> Confiança <br><i class="fas fa-check-circle text-secondary-color"></i> Inovação <br><i class="fas fa-check-circle text-secondary-color"></i> Acessibilidade <br><i class="fas fa-check-circle text-secondary-color"></i> Colaboração</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Slide 4: Objetivo do Site -->
                            <div class="slide w-full h-full">
                                <div class="slide-content-wrapper">
                                    <h2 contenteditable="true" class="editable text-4xl font-bold text-gray-800 text-center mb-12">Nosso Propósito</h2>
                                    <div class="flex items-center gap-12 w-full">
                                        <div class="w-2/5 editable-image-container rounded-lg"><img src="https://placehold.co/600x400/10B981/ffffff?text=Objetivo" alt="Imagem representando o objetivo" class="rounded-lg shadow-xl w-full h-full object-cover"></div>
                                        <div class="w-3/5 text-lg text-gray-700 space-y-4">
                                            <p contenteditable="true" class="editable">O objetivo principal é <strong>facilitar a rotina do profissional de enfermagem</strong>, oferecendo:</p>
                                            <ul class="list-none space-y-3">
                                                <li><i class="fas fa-calculator text-xl text-primary-color"></i> <span contenteditable="true" class="editable"><strong>Agilidade:</strong> Cálculos complexos realizados em segundos.</span></li>
                                                <li><i class="fas fa-shield-alt text-xl text-primary-color"></i> <span contenteditable="true" class="editable"><strong>Segurança:</strong> Redução drástica de erros de medicação e avaliação.</span></li>
                                                <li><i class="fas fa-book-open text-xl text-primary-color"></i> <span contenteditable="true" class="editable"><strong>Conhecimento:</strong> Acesso rápido a informações e escalas validadas.</span></li>
                                                <li><i class="fas fa-graduation-cap text-xl text-primary-color"></i> <span contenteditable="true" class="editable"><strong>Apoio Educacional:</strong> Suporte para estudantes e recém-formados.</span></li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Slide 5: Acessibilidade -->
                            <div class="slide w-full h-full">
                                <div class="slide-content-wrapper text-center">
                                    <h2 contenteditable="true" class="editable text-4xl font-bold text-gray-800 mb-8">Acesso para Todos</h2>
                                    <p contenteditable="true" class="editable text-lg text-gray-600 max-w-3xl mx-auto mb-8">Comprometidos com a WCAG (Web Content Accessibility Guidelines), garantimos que nosso conteúdo seja acessível a todos, incluindo pessoas com deficiência.</p>
                                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 max-w-4xl mx-auto">
                                        <div class="p-4 bg-gray-50 rounded-lg"><i class="fas fa-low-vision text-3xl text-primary-color mb-2"></i><h3 contenteditable="true" class="editable font-bold">Alto Contraste</h3><p contenteditable="true" class="editable text-sm">Cores que facilitam a leitura.</p></div>
                                        <div class="p-4 bg-gray-50 rounded-lg"><i class="fas fa-keyboard text-3xl text-primary-color mb-2"></i><h3 contenteditable="true" class="editable font-bold">Navegação por Teclado</h3><p contenteditable="true" class="editable text-sm">Uso completo sem mouse.</p></div>
                                        <div class="p-4 bg-gray-50 rounded-lg"><i class="fas fa-audio-description text-3xl text-primary-color mb-2"></i><h3 contenteditable="true" class="editable font-bold">Leitores de Tela</h3><p contenteditable="true" class="editable text-sm">Compatibilidade total.</p></div>
                                    </div>
                                </div>
                            </div>

                            <!-- Slide 6: Sustentabilidade Digital -->
                            <div class="slide w-full h-full">
                                <div class="slide-content-wrapper text-center">
                                    <h2 contenteditable="true" class="editable text-4xl font-bold text-gray-800 mb-8">Compromisso com o Futuro Digital</h2>
                                    <p contenteditable="true" class="editable text-lg text-gray-600 max-w-3xl mx-auto mb-8">Adotamos práticas de sustentabilidade digital para minimizar nosso impacto ambiental e garantir a longevidade da plataforma.</p>
                                    <div class="flex justify-center items-center gap-12">
                                        <div class="text-center"><i class="fas fa-server text-5xl text-secondary-color"></i><p contenteditable="true" class="editable mt-2 font-semibold">Hospedagem Verde</p><p contenteditable="true" class="editable text-sm text-gray-500">Servidores alimentados por energia renovável.</p></div>
                                        <div class="text-center"><i class="fas fa-feather-alt text-5xl text-secondary-color"></i><p contenteditable="true" class="editable mt-2 font-semibold">Código Otimizado</p><p contenteditable="true" class="editable text-sm text-gray-500">Menor consumo de energia no seu dispositivo.</p></div>
                                        <div class="text-center"><i class="fas fa-infinity text-5xl text-secondary-color"></i><p contenteditable="true" class="editable mt-2 font-semibold">Design Perene</p><p contenteditable="true" class="editable text-sm text-gray-500">Interfaces que duram, evitando redesenhos constantes.</p></div>
                                    </div>
                                </div>
                            </div>

                            <!-- Slide 7: Políticas do Site -->
                            <div class="slide w-full h-full">
                                <div class="slide-content-wrapper">
                                    <h2 contenteditable="true" class="editable text-4xl font-bold text-gray-800 mb-12">Nossas Diretrizes</h2>
                                    <div class="w-full max-w-4xl text-left space-y-6">
                                        <details class="bg-gray-50 p-4 rounded-lg cursor-pointer">
                                            <summary class="font-bold text-lg text-primary-color editable" contenteditable="true">Política de Privacidade</summary>
                                            <p contenteditable="true" class="editable mt-2 text-gray-600">Respeitamos seus dados. Não coletamos informações pessoais identificáveis sem consentimento e utilizamos apenas o essencial para o funcionamento do site. Não vendemos ou compartilhamos seus dados.</p>
                                        </details>
                                        <details class="bg-gray-50 p-4 rounded-lg cursor-pointer">
                                            <summary class="font-bold text-lg text-primary-color editable" contenteditable="true">Termos de Uso</summary>
                                            <p contenteditable="true" class="editable mt-2 text-gray-600">As ferramentas são para fins educacionais e de apoio, não substituindo o julgamento clínico profissional. O uso do site implica na aceitação de que a responsabilidade final é sempre do profissional de saúde.</p>
                                        </details>
                                         <details class="bg-gray-50 p-4 rounded-lg cursor-pointer">
                                            <summary class="font-bold text-lg text-primary-color editable" contenteditable="true">Política de Cookies</summary>
                                            <p contenteditable="true" class="editable mt-2 text-gray-600">Utilizamos cookies essenciais para a funcionalidade do site e cookies de análise (anônimos) para entender como os usuários interagem com a plataforma e como podemos melhorá-la.</p>
                                        </details>
                                    </div>
                                </div>
                            </div>

                            <!-- Slide 8: Calculadoras de Enfermagem -->
                            <div class="slide w-full h-full">
                                <div class="slide-content-wrapper">
                                    <h2 contenteditable="true" class="editable text-4xl font-bold text-gray-800 mb-12">Calculadoras: Precisão e Agilidade</h2>
                                    <div class="flex items-center gap-12 w-full max-w-5xl">
                                        <div class="w-1/2 space-y-4">
                                            <div class="flex items-center gap-4"><div class="animated-counter text-5xl" data-target="80">0</div><p contenteditable="true" class="editable text-xl text-gray-700">+ Calculadoras disponíveis, cobrindo áreas críticas.</p></div>
                                            <p contenteditable="true" class="editable text-lg"><i class="fas fa-check text-secondary-color"></i> <strong>99.8% de uptime</strong> em 2024.</p>
                                            <p contenteditable="true" class="editable text-lg"><i class="fas fa-check text-secondary-color"></i> <strong>Aumento de 35%</strong> no número de ferramentas no último ano.</p>
                                            <p contenteditable="true" class="editable text-lg"><i class="fas fa-check text-secondary-color"></i> Funcionalidades incluem histórico, referências e modo escuro.</p>
                                        </div>
                                        <div class="w-1/2 h-80">
                                            <canvas id="calculatorsChart"></canvas>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Slide 9: Escalas de Enfermagem -->
                            <div class="slide w-full h-full">
                                <div class="slide-content-wrapper">
                                    <h2 contenteditable="true" class="editable text-4xl font-bold text-gray-800 mb-12">Escalas: Avaliação Criteriosa</h2>
                                     <div class="flex items-center gap-12 w-full max-w-5xl">
                                         <div class="w-1/2 space-y-4">
                                             <div class="flex items-center gap-4"><div class="animated-counter text-5xl" data-target="50">0</div><p contenteditable="true" class="editable text-xl text-gray-700">+ Escalas validadas para avaliação de pacientes.</p></div>
                                             <p contenteditable="true" class="editable text-lg"><i class="fas fa-check text-secondary-color"></i> Economia de até <strong>5 minutos por avaliação</strong>.</p>
                                             <p contenteditable="true" class="editable text-lg"><i class="fas fa-check text-secondary-color"></i> Redução de <strong>erros de transcrição</strong>.</p>
                                             <p contenteditable="true" class="editable text-lg"><i class="fas fa-check text-secondary-color"></i> Resultados com interpretação e conduta sugerida.</p>
                                         </div>
                                         <div class="w-1/2">
                                             <table class="w-full text-left table-auto">
                                                 <thead class="bg-primary-color text-white"><tr><th class="p-2 editable" contenteditable="true">Escala</th><th class="p-2 editable" contenteditable="true">Aplicação</th></tr></thead>
                                                 <tbody>
                                                     <tr class="border-b bg-gray-50"><td class="p-2 font-semibold editable" contenteditable="true">Glasgow</td><td class="p-2 editable" contenteditable="true">Nível de consciência</td></tr>
                                                     <tr class="border-b"><td class="p-2 font-semibold editable" contenteditable="true">Braden</td><td class="p-2 editable" contenteditable="true">Risco de lesão por pressão</td></tr>
                                                     <tr class="border-b bg-gray-50"><td class="p-2 font-semibold editable" contenteditable="true">Morse</td><td class="p-2 editable" contenteditable="true">Risco de queda</td></tr>
                                                     <tr class="border-b"><td class="p-2 font-semibold editable" contenteditable="true">EVA</td><td class="p-2 editable" contenteditable="true">Avaliação da dor</td></tr>
                                                 </tbody>
                                             </table>
                                         </div>
                                     </div>
                                </div>
                            </div>

                            <!-- Slide 10: Conteúdo Adicional -->
                            <div class="slide w-full h-full">
                                <div class="slide-content-wrapper text-center">
                                    <h2 contenteditable="true" class="editable text-4xl font-bold text-gray-800 mb-12">Além das Ferramentas: Conhecimento e Carreira</h2>
                                    <div class="grid grid-cols-4 gap-8 w-full max-w-5xl">
                                        <div class="text-center"><div class="animated-counter text-6xl" data-target="200">0</div><p contenteditable="true" class="editable text-xl font-semibold mt-2">Artigos</p><p contenteditable="true" class="editable text-gray-600">Revisados e atualizados.</p></div>
                                        <div class="text-center"><div class="animated-counter text-6xl" data-target="500">0</div><p contenteditable="true" class="editable text-xl font-semibold mt-2">Vagas</p><p contenteditable="true" class="editable text-gray-600">Oportunidades de carreira.</p></div>
                                        <div class="text-center"><div class="animated-counter text-6xl" data-target="1000">0</div><p contenteditable="true" class="editable text-xl font-semibold mt-2">Questões</p><p contenteditable="true" class="editable text-gray-600">Para concursos e provas.</p></div>
                                        <div class="text-center"><div class="animated-counter text-6xl" data-target="30">0</div><p contenteditable="true" class="editable text-xl font-semibold mt-2">Cursos</p><p contenteditable="true" class="editable text-gray-600">Parcerias para qualificação.</p></div>
                                    </div>
                                </div>
                            </div>

                            <!-- Slide 11: Redes Sociais -->
                            <div class="slide w-full h-full">
                                <div class="slide-content-wrapper text-center">
                                    <h2 contenteditable="true" class="editable text-4xl font-bold text-gray-800 mb-12">Conecte-se Conosco</h2>
                                    <p contenteditable="true" class="editable text-lg text-gray-600 max-w-2xl mx-auto mb-10">Faça parte da nossa comunidade crescente e fique por dentro de todas as novidades, dicas e discussões.</p>
                                    <div class="flex justify-center gap-10 text-4xl">
                                        <a href="#" class="text-blue-800 hover:scale-110 transition-transform"><i class="fab fa-facebook"></i></a>
                                        <a href="#" class="text-pink-600 hover:scale-110 transition-transform"><i class="fab fa-instagram"></i></a>
                                        <a href="#" class="text-blue-500 hover:scale-110 transition-transform"><i class="fab fa-linkedin"></i></a>
                                        <a href="#" class="text-red-600 hover:scale-110 transition-transform"><i class="fab fa-youtube"></i></a>
                                        <a href="#" class="text-gray-800 hover:scale-110 transition-transform"><i class="fab fa-tiktok"></i></a>
                                    </div>
                                </div>
                            </div>

                            <!-- Slide 12: Call to Action -->
                            <div class="slide w-full h-full" style="background: linear-gradient(135deg, #f0f4f8 0%, #d9e2ec 100%);">
                                <div class="slide-content-wrapper text-center">
                                    <div class="brand-logo mb-6 shadow-lg">+</div>
                                    <h2 contenteditable="true" class="editable text-4xl font-bold text-primary-color mb-3">Junte-se à nossa comunidade!</h2>
                                    <p contenteditable="true" class="editable text-xl text-gray-700">Curta, comente, salve e compartilhe conhecimento.</p>
                                    <div class="flex justify-center gap-8 text-4xl text-gray-600 mt-10">
                                        <i class="far fa-heart hover:text-red-500 cursor-pointer transition-colors"></i>
                                        <i class="far fa-bookmark hover:text-yellow-500 cursor-pointer transition-colors"></i>
                                        <i class="far fa-comment-dots hover:text-blue-500 cursor-pointer transition-colors"></i>
                                        <i class="fas fa-share-alt hover:text-green-500 cursor-pointer transition-colors"></i>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>

                    <button id="prev" class="nav-button"><i class="fas fa-chevron-left"></i></button>
                    <button id="next" class="nav-button"><i class="fas fa-chevron-right"></i></button>
                    
                </div>
                <div id="progress-bar-container">
                    <div id="progress-bar"></div>
                </div>
            </div>
        </div>
    </main>
    
    <footer class="bg-[#1A3E74] text-white py-8">
        <div class="max-w-7xl mx-auto px-4">
            <div class="border-b border-white pb-4 mb-4">
                <div class="flex justify-start items-center">
                    <img src="https://www.calculadorasdeenfermagem.com.br/iconrodape1.webp" alt="Logotipo Calculadoras de Enfermagem no rodapé" width="120" height="84" class="h-auto w-auto max-w-[80px] max-h-[80px]" width="80" height="80"" width="80" height="80" loading="lazy" decoding="async">
                </div>
            </div>
            <div class="md:flex md:justify-between md:items-start md:space-x-8 md:items-stretch">
                <div class="mb-6 md:mb-0">
                    <p class="font-bold mb-2">Institucional</p>
                    <ul class="list-none space-y-1">
                        <li><a href="index.html" class="text-white hover:underline">Início</a></li>
                        <li><a href="missao.html" class="text-white hover:underline">Sobre Nós</a></li>
                        <li><a href="mapa-do-site.html" class="text-white hover:underline">Mapa do Site</a></li>
                        <li><a href="politica.html" class="text-white hover:underline">Políticas de Cookies</a></li>
                        <li><a href="politica.html" class="text-white hover:underline">Política de Retenção de dados</a></li>
                        <li><a href="politica.html" class="text-white hover:underline">LGPD</a></li>
                        <li><a href="politica.html" class="text-white hover:underline">Políticas de Privacidade</a></li>
                        <li><a href="termos.html" class="text-white hover:underline">Termos e Condições de Uso</a></li>
                        <li><a href="politicadeacessibilidade.html" class="text-white hover:underline">Política de Acessibilidade</a></li>
                    </ul>
                </div>
                <div class="mb-6 md:mb-0">
                    <h5 class="font-bold mb-2">Sustentabilidade Digital</h5>
                    <ul class="list-none space-y-1">
                        <li><a href="nossocompromisso.html" class="text-white hover:underline">Nosso Compromisso</a></li>
                        <li><a href="impactodigital.html" class="text-white hover:underline">Relatório de Impacto</a></li>
                        <li><a href="tecnologiaverde.html" class="text-white hover:underline">Tecnologia Verde</a></li>
                    </ul>
                </div>
                <div class="mb-6 md:mb-0">
                    <h5 class="font-bold mb-2">Nosso Compromisso</h5>
                    <p class="text-white text-sm mb-2 max-w-sm md:max-w-xs">Nosso site adota como princípio de governança, o comprometimento com elevados padrões de acessibilidade digital, sustentabilidade digital e proteção de dados.</p>
                    <div class="flex space-x-4 items-center justify-start">
                        <img src="https://www.calculadorasdeenfermagem.com.br/seloacessibilidade.webp" alt="Selo de Acessibilidade" width="100" height="100" class="w-auto h-auto max-w-[80px] max-h-[80px]" width="80" height="80"" loading="lazy" decoding="async">
                        <img src="https://www.calculadorasdeenfermagem.com.br/selosustentabilidade.webp" alt="Selo de Sustentabilidade" width="100" height="100" class="w-auto h-auto max-w-[80px] max-h-[80px]" width="80" height="80"" loading="lazy" decoding="async">
                        <img src="https://www.calculadorasdeenfermagem.com.br/selolgpd.webp" alt="Selo LGPD" width="100" height="100" class="w-auto h-auto max-w-[80px] max-h-[80px]" width="80" height="80"" loading="lazy" decoding="async">
                    </div>
                </div>
                <div class="flex flex-1 flex-col md:flex-row justify-end items-start md:items-start">
                    <div class="vertical-divider-footer-stretched hidden md:block"></div>
                    <div class="flex flex-col items-start space-y-4">
                        <h5 class="font-bold mb-2">Siga-nos</h5>
                        <div class="flex space-x-4">
                            <a href="https://linkedin.com/company/calculadoras-de-enfermagem" target="_blank" class="footer-social-icon" title="LinkedIn" aria-label="Acesse Nosso Perfil no LinkedIn"><i class="fab fa-linkedin text-xl"></i></a>
                            <a href="https://www.instagram.com/calculadorasdeenfermagem/" target="_blank" class="footer-social-icon" title="Instagram" aria-label="Acesse Nosso Perfil no Instagram"><i class="fab fa-instagram text-xl"></i></a>
                            <a href="https://www.tiktok.com/@calculadorasdeenf" target="_blank" class="footer-social-icon" title="TikTok" aria-label="Acesse Nosso Perfil no TikTok"><i class="fab fa-tiktok text-xl"></i></a>
                            <a href="https://www.youtube.com/channel/UC_6runTDHz8u5S1Yab842pg" target="_blank" class="footer-social-icon" title="YouTube" aria-label="Acesse Nosso Perfil no YouTube"><i class="fab fa-youtube text-xl"></i></a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="mt-8 text-center">
                <p>© 2025 Calculadoras de Enfermagem. Todos os direitos reservados.</p>
            </div>
            <div id="movedCookieBtn" class="text-center">
                <button id="openGranularCookieModalBtn" class="btn-secondary text-white py-2 px-4 rounded-md" aria-label="Gerenciar Preferências de Cookies">Gerenciar Preferências de Cookies</button>
            </div>
        </div>
    </footer>

    <!-- Firebase SDKs -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-app.js";
        import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-auth.js";
        
        const firebaseConfig = {
            apiKey: "AIzaSyC1US-K0KoiE9OS4IGalxkNUwqSicTPbeA",
            authDomain: "acesso-restrito-github.firebaseapp.com",
            projectId: "acesso-restrito-github",
            storageBucket: "acesso-restrito-github.appspot.com",
            messagingSenderId: "32644970643",
            appId: "1:32644970643:web:92f5f3653ddeaa8ac0b566"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);

        let inactivityTimer;

        function resetTimer() {
            clearTimeout(inactivityTimer);
            inactivityTimer = setTimeout(() => {
                console.log("User inactive. Signing out.");
                signOut(auth);
            }, 30 * 60 * 1000); // 30 minutos
        }

        onAuthStateChanged(auth, (user) => {
            if (user) {
                // User is authenticated
                document.body.style.display = 'block';
                // Dispatch a custom event to signal that authentication is complete
                document.dispatchEvent(new CustomEvent('authReady'));
                
                // Set up or reset inactivity timer
                window.addEventListener('mousemove', resetTimer);
                window.addEventListener('mousedown', resetTimer);
                window.addEventListener('keypress', resetTimer);
                resetTimer();
            } else {
                // User is not authenticated, redirect
                window.location.href = 'https://www.calculadorasdeenfermagem.com.br/institucional/acessorestrito.html';
            }
        });
    </script>

    <script src="global-scripts.js" defer></script>
    <script>
        document.addEventListener('authReady', () => {
            // =================================================================================
            // STATE AND HISTORY MANAGEMENT (UNDO/REDO)
            // =================================================================================
            let history = [];
            let redoStack = [];
            const undoBtn = document.getElementById('undo-btn');
            const redoBtn = document.getElementById('redo-btn');
            let textEditTimeout;

            function getCurrentState() {
                const editableTexts = Array.from(document.querySelectorAll('.editable')).map(el => el.innerHTML);
                const editableImages = Array.from(document.querySelectorAll('.editable-image-container img')).map(img => img.src);

                return {
                    primaryColor: document.getElementById('primaryColorPicker').value,
                    headerTitleColor: document.getElementById('headerTitleColorPicker').value,
                    headerSubtitleColor: document.getElementById('headerSubtitleColorPicker').value,
                    bodyTextColor: document.getElementById('bodyTextColorPicker').value,
                    logo: {
                        position: logoPosition,
                        src: document.querySelector('#logo-selection .selected img')?.src || '',
                        visible: document.getElementById('toggleLogo').checked,
                    },
                    footerVisible: document.getElementById('toggleFooter').checked,
                    texts: editableTexts,
                    images: editableImages,
                };
            }

            function saveState() {
                redoStack = [];
                history.push(getCurrentState());
                updateHistoryButtons();
            }

            function applyState(state) {
                document.getElementById('primaryColorPicker').value = state.primaryColor;
                updatePrimaryColor(state.primaryColor);
                document.getElementById('headerTitleColorPicker').value = state.headerTitleColor;
                updateTextColor('.slide h1, .slide h2, .slide .brand-logo', state.headerTitleColor);
                document.getElementById('headerSubtitleColorPicker').value = state.headerSubtitleColor;
                updateTextColor('.slide p, .slide .slide-footer', state.headerSubtitleColor);
                document.getElementById('bodyTextColorPicker').value = state.bodyTextColor;
                updateTextColor('.slide .text-gray-700, .slide .text-gray-600, .slide .text-primary-color', state.bodyTextColor);

                logoPosition = state.logo.position;
                document.getElementById('toggleLogo').checked = state.logo.visible;
                document.getElementById('toggleFooter').checked = state.footerVisible;
                
                const logoToSelect = document.querySelector(`.logo-choice img[src="${state.logo.src}"]`);
                selectLogo(state.logo.src, logoToSelect ? logoToSelect.parentElement : null, false);
                
                setHeaderLayout(headerLayout, document.querySelector(`[onclick*="setHeaderLayout('${headerLayout}'"]`));
                setFooterLayout(footerLayout, document.querySelector(`[onclick*="setFooterLayout('${footerLayout}'"]`));
                setLogoPosition(logoPosition, document.querySelector(`[onclick*="setLogoPosition('${logoPosition}'"]`));
                toggleElement('logo');
                toggleElement('footer');

                document.querySelectorAll('.editable').forEach((el, i) => {
                    if (state.texts[i] !== undefined) el.innerHTML = state.texts[i];
                });
                document.querySelectorAll('.editable-image-container img').forEach((img, i) => {
                    if (state.images[i] !== undefined) img.src = state.images[i];
                });
                
                updateHistoryButtons();
                adjustAllSlidesContentFit();
            }

            window.undo = function() {
                if (history.length > 1) {
                    redoStack.push(history.pop());
                    applyState(history[history.length - 1]);
                }
            }

            window.redo = function() {
                if (redoStack.length > 0) {
                    const state = redoStack.pop();
                    history.push(state);
                    applyState(state);
                }
            }

            function updateHistoryButtons() {
                undoBtn.disabled = history.length <= 1;
                redoBtn.disabled = redoStack.length === 0;
            }

            function debouncedSaveState() {
                clearTimeout(textEditTimeout);
                textEditTimeout = setTimeout(saveState, 400);
            }

            // =================================================================================
            // DOM ELEMENTS & GLOBAL VARS
            // =================================================================================
            const slider = document.getElementById('slider');
            const slides = document.querySelectorAll('.slide');
            const prevBtn = document.getElementById('prev');
            const nextBtn = document.getElementById('next');
            const progressBar = document.getElementById('progress-bar');
            const loadingOverlay = document.getElementById('loading-overlay');
            const imageUploadInput = document.getElementById('image-upload-input');
            let currentImageTarget = null;

            let currentSlide = 0;
            const totalSlides = slides.length;
            let chartInstance = null;
            let logoPosition = 'header';
            let headerLayout = 'logo-left';
            let footerLayout = 'logo-left';
            
            const templates = {
                classic: { primaryColor: '#1a3e74' },
                corporate: { primaryColor: '#0055A4' },
                modern: { primaryColor: '#00B8D9' },
                fresh: { primaryColor: '#10B981' }
            };

            // =================================================================================
            // CORE FUNCTIONS
            // =================================================================================
            window.openTab = function(event, tabName) {
                document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
                document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
                document.getElementById(tabName).classList.add('active');
                event.currentTarget.classList.add('active');
            }

            function updatePrimaryColor(color) {
                document.documentElement.style.setProperty('--primary-color', color);
                if (chartInstance) {
                    chartInstance.data.datasets[0].borderColor = color;
                    chartInstance.data.datasets[0].backgroundColor = color.replace(')', ', 0.1)').replace('rgb', 'rgba');
                    chartInstance.update();
                }
            }

            window.toggleElement = function(id) {
                if (id === 'logo') {
                    const isLogoVisible = document.getElementById('toggleLogo').checked;
                    document.querySelectorAll('.header-logo-container').forEach(el => el.classList.toggle('hidden', !(isLogoVisible && logoPosition === 'header')));
                    document.querySelectorAll('.footer-logo-container').forEach(el => el.classList.toggle('hidden', !(isLogoVisible && logoPosition === 'footer')));
                } else if (id === 'footer') {
                    const isChecked = document.getElementById('toggleFooter').checked;
                    document.querySelectorAll('.slide-footer-wrapper').forEach(el => el.classList.toggle('hidden', !isChecked));
                }
                adjustAllSlidesContentFit();
            }

            window.resizePresentation = function(format, button) {
                document.querySelectorAll('[onclick^="resizePresentation"]').forEach(btn => btn.classList.remove('active'));
                button.classList.add('active');
                
                const container = document.querySelector('.slide-container');
                const progressContainer = document.getElementById('progress-bar-container');
                
                let width = 500, height = 500;
                if (format === 'portrait') height = 625;
                if (format === 'stories') { width = 450; height = 800; }
                
                container.style.width = `${width}px`;
                container.style.height = `${height}px`;
                progressContainer.style.width = `${width}px`;
                
                setTimeout(() => {
                    adjustAllSlidesContentFit();
                    saveState();
                }, 50);
            };

            function adjustSlideContentFit(slide) {
                const wrapper = slide.querySelector('.slide-content-wrapper');
                if (!wrapper) return;
                wrapper.style.transform = 'scale(1)';
                requestAnimationFrame(() => {
                    const slideHeight = slide.clientHeight;
                    const wrapperHeight = wrapper.scrollHeight;
                    const slideWidth = slide.clientWidth;
                    const wrapperWidth = wrapper.scrollWidth;
                    if (wrapperHeight > slideHeight || wrapperWidth > slideWidth) {
                        const scale = Math.min(slideWidth / wrapperWidth, slideHeight / wrapperHeight);
                        wrapper.style.transform = `scale(${scale})`;
                    } else {
                        wrapper.style.transform = 'scale(1)';
                    }
                });
            }

            function adjustAllSlidesContentFit() {
                slides.forEach(adjustSlideContentFit);
            }

            window.applyTemplate = function(templateName) {
                const t = templates[templateName];
                if (!t) return;
                document.getElementById('primaryColorPicker').value = t.primaryColor;
                updatePrimaryColor(t.primaryColor);
                saveState();
            };

            window.setLogoPosition = function(position, button) {
                if (button) {
                    document.querySelectorAll('[onclick^="setLogoPosition"]').forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');
                }
                logoPosition = position;
                toggleElement('logo');
                saveState();
            };
            
            window.setHeaderLayout = function(layout, button) {
                if (button) {
                    document.querySelectorAll('[onclick^="setHeaderLayout"]').forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');
                }
                headerLayout = layout;
                saveState();
            };

            window.setFooterLayout = function(layout, button) {
                if (button) {
                    document.querySelectorAll('[onclick^="setFooterLayout"]').forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');
                }
                footerLayout = layout;
                saveState();
            };

            window.selectLogo = function(logoUrl, element, doSaveState = true) {
                document.querySelectorAll('.header-logo, .footer-logo').forEach(img => img.src = logoUrl);
                if (element) {
                    document.querySelectorAll('.logo-choice').forEach(e => e.classList.remove('selected'));
                    element.classList.add('selected');
                }
                if(doSaveState) saveState();
            };

            window.updateTextColor = function(selector, color) {
                document.querySelectorAll(selector).forEach(el => el.style.color = color);
            };

            // =================================================================================
            // SLIDER AND CHART
            // =================================================================================
            function goToSlide(slideIndex) {
                if (!slider) return; 
                currentSlide = (slideIndex + totalSlides) % totalSlides;
                slider.style.transform = `translateX(-${currentSlide * 100}%)`;
                updateProgressBar();
                handleSlideContent(currentSlide);
            }

            function updateProgressBar() {
                if (!progressBar) return;
                const progress = ((currentSlide + 1) / totalSlides) * 100;
                progressBar.style.width = `${progress}%`;
            }
            
            function animateCounter(element) {
                const target = +element.dataset.target;
                const duration = 1500;
                const stepTime = 20;
                const steps = duration / stepTime;
                const increment = target / steps;
                let current = 0;
                const timer = setInterval(() => {
                    current += increment;
                    if (current >= target) {
                        clearInterval(timer);
                        current = target;
                    }
                    element.innerText = Math.floor(current);
                }, stepTime);
            }
            
            function handleSlideContent(slideIndex) {
                if (slides[slideIndex].querySelectorAll('.animated-counter').length > 0) {
                    slides[slideIndex].querySelectorAll('.animated-counter').forEach(counter => {
                        counter.innerText = '0';
                        animateCounter(counter);
                    });
                }
                if (slides[slideIndex].querySelector('#calculatorsChart')) {
                    renderChart();
                } else {
                    if (chartInstance) { chartInstance.destroy(); chartInstance = null; }
                }
            }

            function renderChart() {
                if (chartInstance) chartInstance.destroy();
                const ctx = document.getElementById('calculatorsChart').getContext('2d');
                const primaryColor = document.getElementById('primaryColorPicker').value;
                chartInstance = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: ['UTI', 'Clínica', 'Emergência', 'Pediatria', 'Outros'],
                        datasets: [{
                            label: 'Uso por Especialidade',
                            data: [120, 90, 75, 60, 40],
                            backgroundColor: primaryColor.replace(')', ', 0.1)').replace('rgb', 'rgba'),
                            borderColor: primaryColor,
                            borderWidth: 2,
                            borderRadius: 5
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: { legend: { display: false } },
                        scales: { y: { beginAtZero: true, grid: { display: false } }, x: { grid: { display: false } } }
                    }
                });
            }

            // =================================================================================
            // EXPORT FUNCTIONS
            // =================================================================================
            window.exportSingleSlide = async function() {
                loadingOverlay.classList.add('is-visible');
                const slideToExport = slides[currentSlide];
                try {
                    const canvas = await html2canvas(slideToExport, { useCORS: true, scale: 2, backgroundColor: null });
                    const link = document.createElement('a');
                    link.download = `slide-${currentSlide + 1}.png`;
                    link.href = canvas.toDataURL('image/png');
                    link.click();
                } catch (err) {
                    console.error("Erro ao exportar slide:", err);
                    alert("Ocorreu um erro ao exportar o slide.");
                } finally {
                    loadingOverlay.classList.remove('is-visible');
                }
            }

            window.exportAllSlides = async function() {
                loadingOverlay.classList.add('is-visible');
                const zip = new JSZip();
                const originalSlide = currentSlide;

                for (let i = 0; i < totalSlides; i++) {
                    goToSlide(i);
                    await new Promise(resolve => setTimeout(resolve, 550));
                    const slideToExport = slides[i];
                    try {
                        const canvas = await html2canvas(slideToExport, { useCORS: true, scale: 2, backgroundColor: null });
                        const blob = await new Promise(resolve => canvas.toBlob(resolve, 'image/png'));
                        zip.file(`slide-${i + 1}.png`, blob);
                    } catch (err) {
                         console.error(`Erro ao exportar slide ${i + 1}:`, err);
                    }
                }

                try {
                    const zipBlob = await zip.generateAsync({ type: "blob" });
                    const link = document.createElement('a');
                    link.download = 'apresentacao.zip';
                    link.href = URL.createObjectURL(zipBlob);
                    link.click();
                    URL.revokeObjectURL(link.href);
                } catch (err) {
                    console.error("Erro ao gerar ZIP:", err);
                    alert("Ocorreu um erro ao gerar o arquivo ZIP.");
                } finally {
                    goToSlide(originalSlide);
                    loadingOverlay.classList.remove('is-visible');
                }
            }

            // =================================================================================
            // INITIALIZATION & EVENT LISTENERS
            // =================================================================================
            const colorPickerIds = ['primaryColorPicker', 'headerTitleColorPicker', 'headerSubtitleColorPicker', 'bodyTextColorPicker'];
            for (const id of colorPickerIds) {
                const element = document.getElementById(id);
                if (element) {
                    element.addEventListener('change', saveState);
                }
            }

            document.body.addEventListener('input', (e) => {
                if (e.target.classList.contains('editable')) {
                    debouncedSaveState();
                }
            });

            document.body.addEventListener('click', (e) => {
                const container = e.target.closest('.editable-image-container');
                if (container) {
                    currentImageTarget = container.querySelector('img');
                    imageUploadInput.click();
                }
            });

            imageUploadInput.addEventListener('change', (event) => {
                if (!event.target.files || !event.target.files[0] || !currentImageTarget) return;
                const reader = new FileReader();
                reader.onload = (e) => {
                    currentImageTarget.src = e.target.result;
                    setTimeout(saveState, 50);
                };
                reader.readAsDataURL(event.target.files[0]);
                event.target.value = '';
            });

            prevBtn.addEventListener('click', () => goToSlide(currentSlide - 1));
            nextBtn.addEventListener('click', () => goToSlide(currentSlide + 1));
            
            document.addEventListener('keydown', (e) => {
                if (e.ctrlKey && e.key === 'z') { e.preventDefault(); undo(); }
                if (e.ctrlKey && e.key === 'y') { e.preventDefault(); redo(); }
                if (e.key === 'ArrowRight') goToSlide(currentSlide + 1);
                else if (e.key === 'ArrowLeft') goToSlide(currentSlide - 1);
            });

            const geralButton = document.querySelector('.tab-button[onclick*="tab-geral"]');
            openTab({ currentTarget: geralButton }, 'tab-geral');
            
            goToSlide(0);
            applyTemplate('classic');
            selectLogo('https://www.calculadorasdeenfermagem.com.br/icontopbar1.webp', document.querySelector('.logo-choice'), false);
            
            adjustAllSlidesContentFit();
            saveState();
        });
    </script>



<script type="text/javascript">
	atOptions = {
		'key' : '1e009bba81deb2bc366b3c4ac030f6be',
		'format' : 'iframe',
		'height' : 90,
		'width' : 728,
		'params' : {}
	};
</script>

<script src="/lang-selector.js" defer></script>
<div id="adterra-banner-container" style="min-height: 90px; width: 100%; text-align: center; margin: 10px 0;">
    <script type='text/javascript' async src='//pl27876671.effectivegatecpm.com/81/6f/74/816f749f9688a0cf1cae1bcf24b9b5e4.js'></script>
</div>
</body>
</html>
