<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preload" href="/menu-global.html" as="fetch" crossorigin>
    <link rel="preload" href="/global-body-elements.html" as="fetch" crossorigin>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <base href="https://www.calculadorasdeenfermagem.com.br/">
    <title>Gerador de Gráficos para Redes Sociais | Calculadoras de Enfermagem</title>
    <meta name="robots" content="noindex, nofollow">
    <meta name="description" content="Crie gráficos personalizados para posts de enfermagem em redes sociais. Ferramenta para gerar gráficos de barra, pizza, donut e mais.">
    <link rel="canonical" href="https://www.calculadorasdeenfermagem.com.br/institucional/grafico.html">
    <link rel="icon" href="images/favicon.png" type="image/png">
    
    <!-- Scripts e Estilos Globais do Site -->
    <script src="https://cdn.tailwindcss.com" defer></script>
    <link rel="stylesheet" href="global-styles.css" media="print" onload="this.media='all'">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" media="print" onload="this.media='all'">
    <link rel="preconnect" href="https://fonts.googleapis.com&display=swap">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Nunito+Sans:wght@700;800;900&display=swap&display=swap" rel="stylesheet">

    <!-- Scripts Específicos da Ferramenta -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    
    <style>
        /* Estilos Globais do Template Principal */
        :root {
            --primary-color: #1a3e74;
            --primary-dark: #122c50;
            --text-color: #2c2c2c;
            --primary-light: #2a5a94;
            --white: #ffffff;
            --shadow: 0 4px 20px rgba(26, 62, 116, 0.1);
            --border-radius: 12px;
            --background-color: #f8f9fa;
        }
        #global-header-container .max-w-7xl, footer .max-w-7xl { max-width: 1600px !important; }
        
        /* Ajuste para o container principal da ferramenta */
        .main-container {
            margin-top: 85px;
            padding: 0; /* Remover padding para o container da ferramenta tomar a largura toda */
        }

        /* Estilos Específicos da Ferramenta de Gráfico */
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--background-color);
            color: var(--text-color);
        }
        .tool-main-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
            gap: 1.5rem;
            padding: 1.5rem;
            min-height: calc(100vh - 85px); /* Ajustar altura para preencher a tela abaixo do header */
        }
        .editor-panel {
            width: 100%;
            max-width: 420px;
            background: var(--white);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
        }
        .template-viewer {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 1rem;
        }
        .template-container {
            width: 500px;
            height: 500px;
            position: relative;
            background: var(--white);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            transition: all 0.3s ease;
        }
        @media (min-width: 1024px) {
            .tool-main-container {
                flex-direction: row;
                align-items: flex-start;
            }
            .template-landscape #main-content-area { flex-direction: row; }
            .template-landscape #main-chart { width: 60%; }
            .template-landscape #quick-stats { width: 40%; grid-template-columns: repeat(1, 1fr); padding-left: 1rem; }
        }
        @media (max-width: 1023px) {
            .editor-panel { max-width: 600px; }
        }
        .title { font-family: 'Nunito Sans', sans-serif; font-weight: 800; }
        .subtitle { font-family: 'Inter', sans-serif; font-weight: 600; }
        .editable:hover { cursor: text; background-color: rgba(0, 0, 0, 0.05); outline: 2px solid var(--primary-color); border-radius: 4px; }
        .editable:focus { outline: 2px solid var(--primary-color); background-color: rgba(0, 0, 0, 0.08); }
        .tab-buttons { display: flex; border-bottom: 1px solid #e5e7eb; margin-bottom: 1.5rem; flex-wrap: wrap; }
        .tab-button { padding: 0.75rem 1rem; font-size: 0.875rem; font-weight: 600; cursor: pointer; border-bottom: 2px solid transparent; transition: all 0.2s ease; color: #6b7280; }
        .tab-button:hover { color: var(--primary-color); }
        .tab-button.active { color: var(--primary-color); border-bottom-color: var(--primary-color); }
        .tab-content { display: none; }
        .tab-content.active { display: block; animation: fadeIn 0.5s; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .control-section { margin-bottom: 1.5rem; }
        .control-label { display: block; font-size: 0.875rem; font-weight: 600; color: #4b5563; margin-bottom: 0.75rem; }
        .btn-control { padding: 0.5rem; border-radius: 0.5rem; transition: all 0.2s ease; cursor: pointer; border: 1px solid #e5e7eb; background-color: #f9fafb; font-size: 0.875rem; }
        .btn-control:hover { background-color: #f3f4f6; border-color: #d1d5db; }
        .btn-control.active { background-color: var(--primary-color); color: var(--white); border-color: var(--primary-color); }
        .btn-primary { background-color: var(--primary-color); color: var(--white); padding: 0.75rem 1rem; border-radius: 0.5rem; transition: all 0.3s ease; box-shadow: 0 4px 10px rgba(0,0,0,0.1); font-weight: 600; }
        .btn-primary:hover { background-color: var(--primary-light); transform: translateY(-2px); box-shadow: 0 6px 15px rgba(0,0,0,0.15); }
        .logo-choice { padding: 0.5rem; border: 2px solid #e5e7eb; border-radius: 0.5rem; cursor: pointer; transition: all 0.2s ease; }
        .logo-choice:hover, .logo-choice.selected { border-color: var(--primary-color); transform: scale(1.05); }
        .logo-choice img { height: 40px; width: 100%; object-fit: contain; }
        .switch { position: relative; display: inline-block; width: 38px; height: 22px; }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; border-radius: 22px; }
        .slider:before { position: absolute; content: ""; height: 16px; width: 16px; left: 3px; bottom: 3px; background-color: white; transition: .4s; border-radius: 50%; }
        input:checked + .slider { background-color: var(--primary-color); }
        input:checked + .slider:before { transform: translateX(16px); }
        .action-buttons { display: flex; gap: 0.5rem; padding: 0.5rem; background-color: #f3f4f6; border-radius: 0.75rem; margin-bottom: 1.5rem; }
        .action-btn { background: none; border: none; padding: 0.5rem; cursor: pointer; border-radius: 0.5rem; transition: background-color 0.2s; }
        .action-btn:hover { background-color: #e5e7eb; }
        .action-btn:disabled { cursor: not-allowed; opacity: 0.5; }
        .action-btn svg { width: 20px; height: 20px; color: #4b5563; }
        #company-header, #charts-footer { display: flex; align-items: center; gap: 1rem; }
        #company-header, #header-text-container, #charts-footer { text-align: center; }
        .layout-side-by-side { justify-content: space-between; }
        .layout-side-by-side #header-text-container, .layout-side-by-side #footer-text-container { text-align: left; }
        .layout-side-by-side.layout-logo-right { flex-direction: row-reverse; }
        .layout-side-by-side.layout-logo-right #header-text-container, .layout-side-by-side.layout-logo-right #footer-text-container { text-align: right; }
        #header-logo-container, #footer-logo-container { flex-shrink: 0; }
        #header-text-container, #footer-text-container { flex-grow: 1; min-width: 0; }
        #reference-section { padding: 0.5rem 1rem; font-size: 0.7rem; color: #6b7280; border-top: 1px solid #e5e7eb; }
    </style>
</head>
<body style="display: none;">
    <div id="global-header-container"></div>
<div id="language-dropdown-wrapper" class="flex justify-end w-full" style="position:relative; z-index:100; padding-right:2rem;">
  <div class="relative inline-block text-left z-50">
    <button id="langButton" class="flex items-center space-x-2 border px-3 py-1 rounded-lg shadow bg-gray-100">
      <img id="langFlag" src="bandeira-brasil.webp" alt="BR" class="w-5 h-4 rounded-sm">
      <span id="langText" class="text-gray-700 font-medium">Português</span>
      <svg class="w-4 h-4 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
      </svg>
    </button>

    <div id="langMenu" class="hidden absolute right-0 mt-2 w-44 bg-white border rounded-lg shadow-lg">
      <div class="flex items-center px-3 py-2 hover:bg-gray-100 cursor-pointer space-x-2" data-value="pt" data-flag="bandeira-brasil.webp">
        <img src="bandeira-brasil.webp" class="w-5 h-4 rounded-sm" alt="BR"><span>Português</span>
      </div>
      <div class="flex items-center px-3 py-2 hover:bg-gray-100 cursor-pointer space-x-2" data-value="en" data-flag="bandeira-eua.webp">
        <img src="bandeira-eua.webp" class="w-5 h-4 rounded-sm" alt="EN"><span>English</span>
      </div>
      <div class="flex items-center px-3 py-2 hover:bg-gray-100 cursor-pointer space-x-2" data-value="es" data-flag="bandeira-espanha.webp">
        <img src="bandeira-espanha.webp" class="w-5 h-4 rounded-sm" alt="ES"><span>Español</span>
      </div>
      <div class="flex items-center px-3 py-2 hover:bg-gray-100 cursor-pointer space-x-2" data-value="de" data-flag="bandeira-alemanha.webp">
        <img src="bandeira-alemanha.webp" class="w-5 h-4 rounded-sm" alt="DE"><span>Deutsch</span>
      </div>
      <div class="flex items-center px-3 py-2 hover:bg-gray-100 cursor-pointer space-x-2" data-value="it" data-flag="bandeira-italia.webp">
        <img src="bandeira-italia.webp" class="w-5 h-4 rounded-sm" alt="IT"><span>Italiano</span>
      </div>
      <div class="flex items-center px-3 py-2 hover:bg-gray-100 cursor-pointer space-x-2" data-value="fr" data-flag="bandeira-franca.webp">
        <img src="bandeira-franca.webp" class="w-5 h-4 rounded-sm" alt="FR"><span>Français</span>
      </div>
      <div class="flex items-center px-3 py-2 hover:bg-gray-100 cursor-pointer space-x-2" data-value="fr" data-flag="bandeira-franca.webp">
        <img src="bandeira-india.webp" class="w-5 h-4 rounded-sm" alt="HI"><span>भारत</span>
      </div>
      <div class="flex items-center px-3 py-2 hover:bg-gray-100 cursor-pointer space-x-2" data-value="fr" data-flag="bandeira-franca.webp">
        <img src="bandeira-china.webp" class="w-5 h-4 rounded-sm" alt="CN"><span>中国</span>
      </div>
      <div class="flex items-center px-3 py-2 hover:bg-gray-100 cursor-pointer space-x-2" data-value="fr" data-flag="bandeira-franca.webp">
        <img src="bandeira-arabia.webp" class="w-5 h-4 rounded-sm" alt="AR"><span>اللغة العربية</span>
      </div>
      <div class="flex items-center px-3 py-2 hover:bg-gray-100 cursor-pointer space-x-2" data-value="fr" data-flag="bandeira-franca.webp">
        <img src="bandeira-japao.webp" class="w-5 h-4 rounded-sm" alt="JP"><span>日本語</span>
      </div>
    </div>
  </div>
</div><main class="main-container">
        <div class="tool-main-container">
            <!-- PAINEL DE EDIÇÃO (ESQUERDA) -->
            <div class="editor-panel">
                <h2 class="text-2xl font-bold text-gray-800 mb-2">Editor de Gráficos</h2>
                <p class="text-sm text-gray-500 mb-6">Personalize o seu template de forma fácil e rápida.</p>

                <!-- ACTION BUTTONS -->
                <div class="action-buttons">
                    <button id="undo-btn" onclick="undo()" class="action-btn" title="Desfazer (Ctrl+Z)">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9 15L3 9m0 0l6-6M3 9h12a6 6 0 010 12h-3" /></svg>
                    </button>
                    <button id="redo-btn" onclick="redo()" class="action-btn" title="Refazer (Ctrl+Y)">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M15 15l6-6m0 0l-6-6m6 6H9a6 6 0 000 12h3" /></svg>
                    </button>
                </div>

                <!-- ABAS DE NAVEGAÇÃO -->
                <div class="tab-buttons">
                    <button class="tab-button active" onclick="openTab(event, 'tab-geral')">Geral</button>
                    <button class="tab-button" onclick="openTab(event, 'tab-layout')">Layout</button>
                    <button class="tab-button" onclick="openTab(event, 'tab-logo')">Logo</button>
                    <button class="tab-button" onclick="openTab(event, 'tab-grafico')">Gráfico</button>
                    <button class="tab-button" onclick="openTab(event, 'tab-estatisticas')">Estatísticas</button>
                    <button class="tab-button" onclick="openTab(event, 'tab-texto')">Texto</button>
                    <button class="tab-button" onclick="openTab(event, 'tab-referencia')">Referência</button>
                </div>

                <!-- CONTEÚDO DAS ABAS -->
                <div id="tab-geral" class="tab-content active">
                    <div class="control-section">
                        <label class="control-label">Modelos Predefinidos</label>
                        <div class="grid grid-cols-2 gap-2">
                            <button onclick="applyTemplate('classic')" class="btn-control">Clássico</button>
                            <button onclick="applyTemplate('corporate')" class="btn-control">Corporativo</button>
                            <button onclick="applyTemplate('modern')" class="btn-control">Moderno</button>
                            <button onclick="applyTemplate('fresh')" class="btn-control">Fresco</button>
                        </div>
                    </div>
                     <div class="control-section">
                        <label class="control-label">Cores</label>
                         <div class="flex items-center justify-between mb-2">
                            <span>Cor Primária</span>
                            <input type="color" id="primaryColorPicker" value="#1a3e74" class="w-8 h-8 rounded-full border-none cursor-pointer">
                        </div>
                        <div class="flex items-center justify-between">
                            <span>Cor de Fundo</span>
                            <input type="color" id="backgroundColorPicker" value="#f8f9fa" class="w-8 h-8 rounded-full border-none cursor-pointer">
                        </div>
                    </div>
                </div>

                <div id="tab-layout" class="tab-content">
                    <div class="control-section">
                        <label class="control-label">Formato da Imagem</label>
                        <div class="grid grid-cols-2 gap-2">
                            <button onclick="resizeTemplate('square', this)" class="btn-control active">Quadrado (1:1)</button>
                            <button onclick="resizeTemplate('portrait', this)" class="btn-control">Retrato (4:5)</button>
                            <button onclick="resizeTemplate('landscape', this)" class="btn-control">Paisagem (1.91:1)</button>
                            <button onclick="resizeTemplate('stories', this)" class="btn-control">Stories (9:16)</button>
                        </div>
                    </div>
                    <div class="control-section space-y-3">
                        <label class="control-label">Visibilidade dos Elementos</label>
                        <div class="flex items-center justify-between"><span class="text-sm">Mostrar Gráfico</span><label class="switch"><input type="checkbox" onchange="toggleElement('main-chart', this, true)" checked><span class="slider"></span></label></div>
                        <div class="flex items-center justify-between"><span class="text-sm">Mostrar Estatísticas</span><label class="switch"><input type="checkbox" onchange="toggleElement('quick-stats', this, true)" checked><span class="slider"></span></label></div>
                        <div class="flex items-center justify-between"><span class="text-sm">Mostrar Referência</span><label class="switch"><input type="checkbox" id="toggleReference" onchange="toggleElement('reference-section', this, true)"><span class="slider"></span></label></div>
                        <div class="flex items-center justify-between"><span class="text-sm">Mostrar Rodapé</span><label class="switch"><input type="checkbox" id="toggleFooter" onchange="toggleElement('charts-footer', this, true)"><span class="slider"></span></label></div>
                    </div>
                </div>
                
                <div id="tab-logo" class="tab-content">
                    <div class="control-section">
                        <label class="control-label">Visibilidade do Logo</label>
                         <div class="flex items-center justify-between"><span class="text-sm">Mostrar Logo</span><label class="switch"><input type="checkbox" id="toggleLogo" onchange="toggleElement('logo', this)"><span class="slider"></span></label></div>
                    </div>
                     <div class="control-section">
                        <label class="control-label">Posição do Logo</label>
                        <div class="grid grid-cols-2 gap-2">
                            <button onclick="setLogoPosition('header', this)" class="btn-control active">Cabeçalho</button>
                            <button onclick="setLogoPosition('footer', this)" class="btn-control">Rodapé</button>
                        </div>
                    </div>
                    <div class="control-section">
                        <label class="control-label">Layout do Cabeçalho</label>
                        <div class="grid grid-cols-2 gap-2">
                            <button onclick="setHeaderLayout('logo-left', this)" class="btn-control active">Logo Esquerda</button>
                            <button onclick="setHeaderLayout('logo-right', this)" class="btn-control">Logo Direita</button>
                        </div>
                    </div>
                     <div class="control-section">
                        <label class="control-label">Layout do Rodapé</label>
                        <div class="grid grid-cols-2 gap-2">
                            <button onclick="setFooterLayout('logo-left', this)" class="btn-control active">Logo Esquerda</button>
                            <button onclick="setFooterLayout('logo-right', this)" class="btn-control">Logo Direita</button>
                        </div>
                    </div>
                    <div class="control-section">
                        <label class="control-label">Selecionar Logo</label>
                        <div id="logo-selection" class="grid grid-cols-3 gap-2">
                            <div class="logo-choice" onclick="selectLogo('https://www.calculadorasdeenfermagem.com.br/icontopbar1.webp', this)"><img src="https://www.calculadorasdeenfermagem.com.br/icontopbar1.webp" alt="Logo 1"></div>
                            <div class="logo-choice" onclick="selectLogo('https://www.calculadorasdeenfermagem.com.br/iconpages.webp', this)"><img src="https://www.calculadorasdeenfermagem.com.br/iconpages.webp" alt="Logo 2" width="128" height="192"></div>
                        </div>
                    </div>
                </div>

                <div id="tab-grafico" class="tab-content">
                    <div class="control-section">
                        <label class="control-label">Tipo de Gráfico</label>
                        <div class="grid grid-cols-3 gap-2">
                            <button onclick="setChartType('doughnut', this)" class="btn-control active">Donut</button>
                            <button onclick="setChartType('bar', this)" class="btn-control">Barra</button>
                            <button onclick="setChartType('line', this)" class="btn-control">Linha</button>
                            <button onclick="setChartType('pie', this)" class="btn-control">Pizza</button>
                            <button onclick="setChartType('radar', this)" class="btn-control">Radar</button>
                            <button onclick="setChartType('polarArea', this)" class="btn-control">Polar</button>
                        </div>
                    </div>
                     <div class="control-section">
                        <label class="control-label">Posição da Legenda</label>
                        <div class="grid grid-cols-2 gap-2">
                            <button onclick="setLegendPosition('top', this)" class="btn-control">Acima</button>
                            <button onclick="setLegendPosition('bottom', this)" class="btn-control active">Abaixo</button>
                            <button onclick="setLegendPosition('left', this)" class="btn-control">Esquerda</button>
                            <button onclick="setLegendPosition('right', this)" class="btn-control">Direita</button>
                        </div>
                    </div>
                    <div class="control-section">
                        <label class="control-label">Dados do Gráfico</label>
                        <div id="chart-data-inputs" class="space-y-2 mb-2 max-h-48 overflow-y-auto pr-2"></div>
                        <div class="flex space-x-2">
                            <button onclick="addDataPoint()" class="flex-1 btn-control text-sm">+ Adicionar</button>
                            <button onclick="removeDataPoint()" class="flex-1 btn-control text-sm">- Remover</button>
                        </div>
                    </div>
                     <button onclick="applyChartData()" class="w-full btn-primary text-sm">Aplicar Dados</button>
                </div>

                <div id="tab-estatisticas" class="tab-content">
                    <div class="control-section">
                        <label class="control-label">Editar Estatísticas</label>
                        <div id="stats-editor" class="space-y-2 mb-2 max-h-60 overflow-y-auto pr-2"></div>
                         <div class="flex space-x-2 mt-4">
                            <button onclick="addStatCard()" class="flex-1 btn-control text-sm">+ Adicionar</button>
                            <button onclick="removeLastStatCard()" class="flex-1 btn-control text-sm">- Remover Última</button>
                        </div>
                    </div>
                </div>

                <div id="tab-texto" class="tab-content">
                    <div class="control-section">
                        <label class="control-label">Título Principal</label>
                        <div class="flex items-center justify-between">
                            <span>Cor</span>
                            <input type="color" id="titleColorPicker" value="#ffffff" oninput="updateTextColor('main-title', this.value)" class="w-8 h-8 rounded-full border-none cursor-pointer">
                        </div>
                    </div>
                     <div class="control-section">
                        <label class="control-label">Subtítulo</label>
                        <div class="flex items-center justify-between">
                            <span>Cor</span>
                            <input type="color" id="subtitleColorPicker" value="#ffffff" oninput="updateTextColor('main-subtitle', this.value)" class="w-8 h-8 rounded-full border-none cursor-pointer">
                        </div>
                    </div>
                    <div class="control-section">
                        <label class="control-label">Texto das Estatísticas</label>
                        <div class="flex items-center justify-between mb-2">
                            <span>Cor do Número</span>
                            <input type="color" id="statNumberColorPicker" value="#1a3e74" oninput="updateStatNumberColor(this.value)" class="w-8 h-8 rounded-full border-none cursor-pointer">
                        </div>
                        <div class="flex items-center justify-between mt-2">
                            <span>Cor do Rótulo</span>
                            <input type="color" id="statLabelColorPicker" value="#6b7280" oninput="updateStatLabelColor(this.value)" class="w-8 h-8 rounded-full border-none cursor-pointer">
                        </div>
                    </div>
                </div>

                <div id="tab-referencia" class="tab-content">
                    <div class="control-section">
                        <label for="reference-text-input" class="control-label">Texto da Referência</label>
                        <textarea id="reference-text-input" rows="4" class="w-full p-2 border rounded text-sm" oninput="updateReferenceText(this.value)"></textarea>
                    </div>
                </div>
                
                <!-- Botão de Exportar Fixo no Fundo -->
                <div class="mt-auto pt-6 border-t border-gray-200">
                    <button onclick="exportTemplate()" class="w-full btn-primary">Exportar como PNG</button>
                </div>
            </div>

            <!-- VISUALIZADOR DO TEMPLATE (DIREITA) -->
            <div class="template-viewer">
                <div class="template-container">
                    <!-- Cabeçalho -->
                    <div id="company-header" class="p-4 text-white flex-shrink-0" style="background-color: var(--primary-color);">
                        <div id="header-logo-container" class="hidden">
                            <img id="header-logo" src="https://www.calculadorasdeenfermagem.com.br/icontopbar1.webp" alt="Logotipo" class="h-12 w-auto">
                        </div>
                        <div id="header-text-container">
                            <div class="title editable" id="main-title" style="font-size: 24px;">ESTATÍSTICAS DE SAÚDE</div>
                            <div class="subtitle editable" id="main-subtitle" style="font-size: 14px;">Dados importantes para enfermagem</div>
                        </div>
                    </div>

                    <!-- Conteúdo Principal -->
                    <div id="main-content-area" class="p-4 flex-1 flex flex-col justify-start min-h-0">
                        <!-- Gráfico -->
                        <div id="main-chart" class="relative flex-grow min-h-0">
                            <canvas id="mainChart"></canvas>
                        </div>
                        <!-- Estatísticas -->
                        <div id="quick-stats" class="grid grid-cols-3 gap-3 pt-2 flex-shrink-0">
                            <div class="stat-card text-center bg-blue-50 p-2 rounded-lg"><div class="stat-number font-bold editable" style="color: var(--primary-color); font-size: 20px;">85%</div><div class="stat-label text-gray-600 editable" style="font-size: 12px;">Recuperação</div></div>
                            <div class="stat-card text-center bg-purple-50 p-2 rounded-lg"><div class="stat-number font-bold editable" style="color: var(--primary-color); font-size: 20px;">24h</div><div class="stat-label text-gray-600 editable" style="font-size: 12px;">Atendimento</div></div>
                            <div class="stat-card text-center bg-green-50 p-2 rounded-lg"><div class="stat-number font-bold editable" style="color: var(--primary-color); font-size: 20px;">98%</div><div class="stat-label text-gray-600 editable" style="font-size: 12px;">Satisfação</div></div>
                        </div>
                    </div>
                    
                    <!-- Seção de Referência -->
                    <div id="reference-section" class="hidden">
                        <p class="editable">Fonte: Dados fictícios para demonstração.</p>
                    </div>

                    <!-- Rodapé -->
                    <div id="charts-footer" class="hidden text-white p-3 flex-shrink-0" style="background-color: var(--primary-color);">
                        <div id="footer-text-container">
                            <a href="https://www.calculadorasdeenfermagem.com.br" target="_blank" class="text-xs font-medium editable">www.calculadorasdeenfermagem.com.br</a>
                        </div>
                        <div id="footer-logo-container" class="hidden">
                             <img id="footer-logo" src="https://www.calculadorasdeenfermagem.com.br/icontopbar1.webp" alt="Logotipo no Rodapé" class="h-8 w-auto">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
    
    <footer class="bg-[#1A3E74] text-white py-8">
        <div class="max-w-7xl mx-auto px-4">
            <div class="border-b border-white pb-4 mb-4">
                <div class="flex justify-start items-center">
                    <img src="https://www.calculadorasdeenfermagem.com.br/iconrodape1.webp" alt="Logotipo Calculadoras de Enfermagem no rodapé" width="120" height="84" class="h-auto w-auto max-w-[80px] max-h-[80px]" width="80" height="80" loading="lazy" decoding="async">
                </div>
            </div>
            <div class="md:flex md:justify-between md:items-start md:space-x-8 md:items-stretch">
                <div class="mb-6 md:mb-0">
                    <h5 class="font-bold mb-2">Institucional</h5>
                    <ul class="list-none space-y-1">
                        <li><a href="index.html" class="text-white hover:underline">Início</a></li>
                        <li><a href="missao.html" class="text-white hover:underline">Sobre Nós</a></li>
                        <li><a href="mapa-do-site.html" class="text-white hover:underline">Mapa do Site</a></li>
                        <li><a href="politica.html" class="text-white hover:underline">Políticas de Cookies</a></li>
                        <li><a href="politica.html" class="text-white hover:underline">Política de Retenção de dados</a></li>
                        <li><a href="politica.html" class="text-white hover:underline">LGPD</a></li>
                        <li><a href="politica.html" class="text-white hover:underline">Políticas de Privacidade</a></li>
                        <li><a href="termos.html" class="text-white hover:underline">Termos e Condições de Uso</a></li>
                        <li><a href="politicadeacessibilidade.html" class="text-white hover:underline">Política de Acessibilidade</a></li>
                    </ul>
                </div>
                <div class="mb-6 md:mb-0">
                    <h5 class="font-bold mb-2">Sustentabilidade Digital</h5>
                    <ul class="list-none space-y-1">
                        <li><a href="nossocompromisso.html" class="text-white hover:underline">Nosso Compromisso</a></li>
                        <li><a href="impactodigital.html" class="text-white hover:underline">Relatório de Impacto</a></li>
                        <li><a href="tecnologiaverde.html" class="text-white hover:underline">Tecnologia Verde</a></li>
                    </ul>
                </div>
                <div class="mb-6 md:mb-0">
                    <h5 class="font-bold mb-2">Nosso Compromisso</h5>
                    <p class="text-white text-sm mb-2 max-w-sm md:max-w-xs">Nosso site adota como princípio de governança, o comprometimento com elevados padrões de acessibilidade digital, sustentabilidade digital e proteção de dados.</p>
                    <div class="flex space-x-4 items-center justify-start">
                        <img src="https://www.calculadorasdeenfermagem.com.br/seloacessibilidade.webp" alt="Selo de Acessibilidade" width="100" height="100" class="w-auto h-auto max-w-[80px] max-h-[80px]" loading="lazy" decoding="async">
                        <img src="https://www.calculadorasdeenfermagem.com.br/selosustentabilidade.webp" alt="Selo de Sustentabilidade" width="100" height="100" class="w-auto h-auto max-w-[80px] max-h-[80px]" loading="lazy" decoding="async">
                        <img src="https://www.calculadorasdeenfermagem.com.br/selolgpd.webp" alt="Selo LGPD" width="100" height="100" class="w-auto h-auto max-w-[80px] max-h-[80px]" loading="lazy" decoding="async">
                    </div>
                </div>
                <div class="flex flex-1 flex-col md:flex-row justify-end items-start md:items-start">
                    <div class="vertical-divider-footer-stretched hidden md:block"></div>
                    <div class="flex flex-col items-start space-y-4">
                        <h5 class="font-bold mb-2">Siga-nos</h5>
                        <div class="flex space-x-4">
                            <a href="https://linkedin.com/company/calculadoras-de-enfermagem" target="_blank" class="footer-social-icon" title="LinkedIn" aria-label="Acesse Nosso Perfil no LinkedIn"><i class="fab fa-linkedin text-xl"></i></a>
                            <a href="https://www.instagram.com/calculadorasdeenfermagem/" target="_blank" class="footer-social-icon" title="Instagram" aria-label="Acesse Nosso Perfil no Instagram"><i class="fab fa-instagram text-xl"></i></a>
                            <a href="https://www.tiktok.com/@calculadorasdeenf" target="_blank" class="footer-social-icon" title="TikTok" aria-label="Acesse Nosso Perfil no TikTok"><i class="fab fa-tiktok text-xl"></i></a>
                            <a href="https://www.youtube.com/channel/UC_6runTDHz8u5S1Yab842pg" target="_blank" class="footer-social-icon" title="YouTube" aria-label="Acesse Nosso Perfil no YouTube"><i class="fab fa-youtube text-xl"></i></a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="mt-8 text-center">
                <p>© 2025 Calculadoras de Enfermagem. Todos os direitos reservados.</p>
            </div>
            <div id="movedCookieBtn" class="text-center">
                <button id="openGranularCookieModalBtn" class="btn-secondary text-white py-2 px-4 rounded-md" aria-label="Gerenciar Preferências de Cookies">Gerenciar Preferências de Cookies</button>
            </div>
        </div>
    </footer>

    <!-- Firebase SDKs -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        
        const firebaseConfig = {
            apiKey: "AIzaSyC1US-K0KoiE9OS4IGalxkNUwqSicTPbeA",
            authDomain: "acesso-restrito-github.firebaseapp.com",
            projectId: "acesso-restrito-github",
            storageBucket: "acesso-restrito-github.appspot.com",
            messagingSenderId: "32644970643",
            appId: "1:32644970643:web:92f5f3653ddeaa8ac0b566"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);

        let inactivityTimer;

        function resetTimer() {
            clearTimeout(inactivityTimer);
            inactivityTimer = setTimeout(() => {
                console.log("User inactive. Signing out.");
                signOut(auth);
            }, 30 * 60 * 1000); // 30 minutos
        }

        onAuthStateChanged(auth, (user) => {
            console.log("onAuthStateChanged triggered");
            if (user) {
                console.log("Usuário autenticado:", user.uid);
                document.body.style.display = 'block';
                document.dispatchEvent(new CustomEvent('authReady'));
                
                window.addEventListener('mousemove', resetTimer);
                window.addEventListener('mousedown', resetTimer);
                window.addEventListener('keypress', resetTimer);
                resetTimer();
            } else {
                console.log("Usuário não autenticado. Redirecionando...");
                window.location.href = 'https://www.calculadorasdeenfermagem.com.br/institucional/acessorestrito.html';
            }
        });
    </script>

    <script src="global-scripts.js" defer></script>
    <script>
        document.addEventListener('authReady', () => {
            console.log("Evento authReady recebido");
            initializeAppTool();
        });

        function initializeAppTool() {
            // --- VARIÁVEIS GLOBAIS E ESTADO DA APLICAÇÃO ---
            let myChart;
            let chartData = {
                labels: ['Cardiovascular', 'Respiratório', 'Neurológico', 'Digestivo', 'Outros'],
                datasets: [{
                    data: [30, 25, 20, 15, 10],
                    backgroundColor: ['#1a3e74', '#2a5a94', '#4a90e2', '#7bb3f0', '#a8d0f7'],
                    borderWidth: 0,
                }]
            };
            let chartType = 'doughnut';
            let legendPosition = 'bottom';
            let logoPosition = 'header';
            let headerLayout = 'logo-left';
            let footerLayout = 'logo-left';

            let history = [];
            let historyIndex = -1;

            const templateContainer = document.querySelector('.template-container');
            const primaryColorPicker = document.getElementById('primaryColorPicker');
            const backgroundColorPicker = document.getElementById('backgroundColorPicker');
            const chartDataInputsContainer = document.getElementById('chart-data-inputs');
            const statsEditorContainer = document.getElementById('stats-editor');
            const undoBtn = document.getElementById('undo-btn');
            const redoBtn = document.getElementById('redo-btn');

            const templates = {
                classic: { primaryColor: '#1a3e74', backgroundColor: '#f8f9fa', chartType: 'doughnut', title: 'ESTATÍSTICAS DE SAÚDE', subtitle: 'Dados importantes para enfermagem' },
                corporate: { primaryColor: '#0055A4', backgroundColor: '#ffffff', chartType: 'bar', title: 'RELATÓRIO FINANCEIRO', subtitle: 'Performance do último trimestre' },
                modern: { primaryColor: '#00B8D9', backgroundColor: '#F3F4F6', chartType: 'line', title: 'TENDÊNCIA DE MERCADO', subtitle: 'Análise de dados recente' },
                fresh: { primaryColor: '#10B981', backgroundColor: '#F0FDF4', chartType: 'pie', title: 'IMPACTO AMBIENTAL', subtitle: 'Distribuição de recursos' }
            };

            function saveState() {
                const state = {
                    primaryColor: primaryColorPicker.value,
                    backgroundColor: backgroundColorPicker.value,
                    mainTitleHTML: document.getElementById('main-title').innerHTML,
                    mainSubtitleHTML: document.getElementById('main-subtitle').innerHTML,
                    footerTextHTML: document.querySelector('#charts-footer a').innerHTML,
                    referenceHTML: document.querySelector('#reference-section .editable').innerHTML,
                    chartData: JSON.parse(JSON.stringify(chartData)),
                    chartType: chartType,
                    legendPosition: legendPosition,
                    logoPosition: logoPosition,
                    headerLayout: headerLayout,
                    footerLayout: footerLayout,
                    logoSrc: document.getElementById('header-logo').src,
                    statsHTML: document.getElementById('quick-stats').innerHTML,
                    visibility: {
                        logo: document.getElementById('toggleLogo').checked,
                        chart: document.querySelector('[onchange*="main-chart"]').checked,
                        stats: document.querySelector('[onchange*="quick-stats"]').checked,
                        reference: document.getElementById('toggleReference').checked,
                        footer: document.getElementById('toggleFooter').checked,
                    }
                };
                if (historyIndex < history.length - 1) {
                    history = history.slice(0, historyIndex + 1);
                }
                history.push(state);
                historyIndex++;
                updateHistoryButtons();
            }

            function restoreState(state) {
                primaryColorPicker.value = state.primaryColor;
                backgroundColorPicker.value = state.backgroundColor;
                document.documentElement.style.setProperty('--primary-color', state.primaryColor);
                document.documentElement.style.setProperty('--background-color', state.backgroundColor);
                updateHeaderAndFooterColors(false);

                document.getElementById('main-title').innerHTML = state.mainTitleHTML;
                document.getElementById('main-subtitle').innerHTML = state.mainSubtitleHTML;
                document.querySelector('#charts-footer a').innerHTML = state.footerTextHTML;
                document.querySelector('#reference-section .editable').innerHTML = state.referenceHTML;
                
                chartData = JSON.parse(JSON.stringify(state.chartData));
                chartType = state.chartType;
                legendPosition = state.legendPosition;
                createChart();
                populateChartDataInputs();

                logoPosition = state.logoPosition;
                headerLayout = state.headerLayout;
                footerLayout = state.footerLayout;
                document.getElementById('header-logo').src = state.logoSrc;
                document.getElementById('footer-logo').src = state.logoSrc;
                setHeaderLayout(state.headerLayout, document.querySelector(`[onclick*="setHeaderLayout('${state.headerLayout}'"]`), false);
                setFooterLayout(state.footerLayout, document.querySelector(`[onclick*="setFooterLayout('${state.footerLayout}'"]`), false);
                setLogoPosition(state.logoPosition, document.querySelector(`[onclick*="setLogoPosition('${state.logoPosition}'"]`), false);

                document.getElementById('quick-stats').innerHTML = state.statsHTML;
                populateStatsEditor();
                setupEditableElements();

                document.getElementById('toggleLogo').checked = state.visibility.logo;
                toggleElement('logo', {checked: state.visibility.logo}, false);
                document.querySelector('[onchange*="main-chart"]').checked = state.visibility.chart;
                toggleElement('main-chart', {checked: state.visibility.chart}, false);
                document.querySelector('[onchange*="quick-stats"]').checked = state.visibility.stats;
                toggleElement('quick-stats', {checked: state.visibility.stats}, false);
                document.getElementById('toggleReference').checked = state.visibility.reference;
                toggleElement('reference-section', {checked: state.visibility.reference}, false);
                document.getElementById('toggleFooter').checked = state.visibility.footer;
                toggleElement('charts-footer', {checked: state.visibility.footer}, false);
            }

            window.undo = function() {
                if (historyIndex > 0) {
                    historyIndex--;
                    restoreState(history[historyIndex]);
                    updateHistoryButtons();
                }
            }

            window.redo = function() {
                if (historyIndex < history.length - 1) {
                    historyIndex++;
                    restoreState(history[historyIndex]);
                    updateHistoryButtons();
                }
            }

            function updateHistoryButtons() {
                undoBtn.disabled = historyIndex <= 0;
                redoBtn.disabled = historyIndex >= history.length - 1;
            }

            window.createChart = function() {
                if (myChart) myChart.destroy();
                const ctx = document.getElementById('mainChart').getContext('2d');
                myChart = new Chart(ctx, {
                    type: chartType,
                    data: chartData,
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: { legend: { position: legendPosition, labels: { font: { size: 10, family: 'Inter' }, padding: 8 } } },
                        animation: { duration: 800, easing: 'easeInOutQuad' },
                        scales: (chartType === 'bar' || chartType === 'line') ? { y: { beginAtZero: true } } : {}
                    }
                });
                adjustContentToSize(parseFloat(templateContainer.style.width) || 500, parseFloat(templateContainer.style.height) || 500);
            }

            window.openTab = function(event, tabName) {
                document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
                document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
                document.getElementById(tabName).classList.add('active');
                event.currentTarget.classList.add('active');
            }

            function setupEditableElements() {
                document.querySelectorAll('.editable').forEach(el => {
                    if (el.dataset.listener) return;
                    el.contentEditable = true;
                    el.dataset.listener = true;
                    el.addEventListener('keydown', e => {
                        if (e.key === 'Enter' && !e.shiftKey) { e.preventDefault(); el.blur(); }
                    });
                    el.addEventListener('blur', saveState);
                });
            }

            window.applyTemplate = function(templateName) {
                const t = templates[templateName];
                if (!t) return;
                
                primaryColorPicker.value = t.primaryColor;
                backgroundColorPicker.value = t.backgroundColor;
                document.documentElement.style.setProperty('--primary-color', t.primaryColor);
                document.documentElement.style.setProperty('--background-color', t.backgroundColor);
                
                document.getElementById('main-title').textContent = t.title;
                document.getElementById('main-subtitle').textContent = t.subtitle;
                
                setChartType(t.chartType, document.querySelector(`.btn-control[onclick*="'${t.chartType}'"]`), false);
                updateHeaderAndFooterColors(false);

                document.getElementById('toggleFooter').checked = true;
                toggleElement('charts-footer', {checked: true}, false);
                
                resizeTemplate('square', document.querySelector('[onclick*="square"]'));
                saveState();
            }

            window.resizeTemplate = function(format, button) {
                document.querySelectorAll('[onclick^="resizeTemplate"]').forEach(btn => btn.classList.remove('active'));
                button.classList.add('active');
                
                templateContainer.classList.remove('template-landscape');
                let width = 500, height = 500;
                if (format === 'landscape') { height = Math.round(500 / 1.91); templateContainer.classList.add('template-landscape'); }
                if (format === 'portrait') height = 625;
                if (format === 'stories') height = Math.round(500 * (16 / 9));
                
                templateContainer.style.width = `${width}px`;
                templateContainer.style.height = `${height}px`;
                
                adjustContentToSize(width, height);
                saveState();
            }

            function adjustContentToSize(width, height) {
                const baseSize = Math.min(width, height);
                const titleSize = Math.max(16, baseSize * 0.05);
                const subtitleSize = Math.max(10, baseSize * 0.03);
                const statNumberSize = Math.max(14, baseSize * 0.04);
                const statLabelSize = Math.max(8, baseSize * 0.025);
                const legendFontSize = Math.max(8, baseSize * 0.02);

                document.getElementById('main-title').style.fontSize = `${titleSize}px`;
                document.getElementById('main-subtitle').style.fontSize = `${subtitleSize}px`;
                document.querySelectorAll('.stat-number').forEach(el => el.style.fontSize = `${statNumberSize}px`);
                document.querySelectorAll('.stat-label').forEach(el => el.style.fontSize = `${statLabelSize}px`);

                if (myChart) {
                    myChart.options.plugins.legend.labels.font.size = legendFontSize;
                    myChart.update();
                    setTimeout(() => myChart.resize(), 50);
                }
            }

            window.toggleElement = function(id, checkbox, doSaveState = true) {
                if (id === 'logo') {
                    const isChecked = checkbox.checked;
                    document.getElementById('header-logo-container').classList.toggle('hidden', !(isChecked && logoPosition === 'header'));
                    document.getElementById('footer-logo-container').classList.toggle('hidden', !(isChecked && logoPosition === 'footer'));
                    updateAlignment();
                } else {
                     document.getElementById(id).classList.toggle('hidden', !checkbox.checked);
                }
                if (doSaveState) saveState();
            }
            
            window.exportTemplate = function() {
                const editorPanel = document.querySelector('.editor-panel');
                editorPanel.style.display = 'none';
                html2canvas(document.querySelector('.template-viewer'), { useCORS: true, scale: 2, backgroundColor: null })
                    .then(canvas => {
                        const link = document.createElement('a');
                        link.download = 'meu-grafico.png';
                        link.href = canvas.toDataURL('image/png');
                        link.click();
                        editorPanel.style.display = 'flex';
                    }).catch(() => { editorPanel.style.display = 'flex'; });
            }

            window.setChartType = function(type, button, doSaveState = true) {
                document.querySelectorAll('[onclick^="setChartType"]').forEach(btn => btn.classList.remove('active'));
                button.classList.add('active');
                chartType = type;
                createChart();
                if (doSaveState) saveState();
            }

            window.setLegendPosition = function(position, button, doSaveState = true) {
                document.querySelectorAll('[onclick^="setLegendPosition"]').forEach(btn => btn.classList.remove('active'));
                button.classList.add('active');
                legendPosition = position;
                createChart();
                if (doSaveState) saveState();
            }

            function populateChartDataInputs() {
                chartDataInputsContainer.innerHTML = '';
                chartData.labels.forEach((label, index) => {
                    const div = document.createElement('div');
                    div.className = 'flex gap-2 items-center';
                    div.innerHTML = `
                        <input type="text" class="flex-1 p-2 text-xs border rounded" value="${label}" placeholder="Rótulo">
                        <input type="number" class="w-1/4 p-2 text-xs border rounded" value="${chartData.datasets[0].data[index]}" placeholder="Valor">
                    `;
                    chartDataInputsContainer.appendChild(div);
                });
            }

            window.addDataPoint = function() {
                chartData.labels.push('Novo');
                chartData.datasets[0].data.push(10);
                const randomColor = `hsl(${Math.random() * 360}, 70%, 60%)`;
                chartData.datasets[0].backgroundColor.push(randomColor);
                populateChartDataInputs();
                applyChartData();
            }

            window.removeDataPoint = function() {
                if (chartData.labels.length > 1) {
                    chartData.labels.pop();
                    chartData.datasets[0].data.pop();
                    chartData.datasets[0].backgroundColor.pop();
                    populateChartDataInputs();
                    applyChartData();
                }
            }

            window.applyChartData = function() {
                const labelInputs = chartDataInputsContainer.querySelectorAll('input[type="text"]');
                const dataInputs = chartDataInputsContainer.querySelectorAll('input[type="number"]');
                chartData.labels = Array.from(labelInputs).map(input => input.value);
                chartData.datasets[0].data = Array.from(dataInputs).map(input => parseFloat(input.value) || 0);
                createChart();
                saveState();
            }
            
            function populateStatsEditor() {
                statsEditorContainer.innerHTML = '';
                const statCards = document.querySelectorAll('#quick-stats .stat-card');
                statCards.forEach((card, index) => {
                    const number = card.querySelector('.stat-number').textContent;
                    const label = card.querySelector('.stat-label').textContent;
                    const div = document.createElement('div');
                    div.className = 'flex gap-2 items-center';
                    div.innerHTML = `
                        <input type="text" class="w-1/3 p-2 text-xs border rounded" value="${number}" placeholder="Número" oninput="updateStatCard(${index}, 'number', this.value)">
                        <input type="text" class="flex-1 p-2 text-xs border rounded" value="${label}" placeholder="Rótulo" oninput="updateStatCard(${index}, 'label', this.value)">
                    `;
                    statsEditorContainer.appendChild(div);
                });
            }

            window.updateStatCard = function(index, part, value) {
                const card = document.querySelectorAll('#quick-stats .stat-card')[index];
                if (card) {
                    card.querySelector(`.stat-${part}`).textContent = value;
                }
                clearTimeout(window.saveStateTimeout);
                window.saveStateTimeout = setTimeout(saveState, 500);
            }

            window.addStatCard = function() {
                const statsContainer = document.getElementById('quick-stats');
                const newCard = document.createElement('div');
                newCard.className = 'stat-card text-center bg-gray-100 p-2 rounded-lg';
                newCard.innerHTML = `
                    <div class="stat-number font-bold editable" style="color: var(--primary-color); font-size: 20px;">0</div>
                    <div class="stat-label text-gray-600 editable" style="font-size: 12px;">Novo</div>
                `;
                statsContainer.appendChild(newCard);
                adjustContentToSize(parseFloat(templateContainer.style.width) || 500, parseFloat(templateContainer.style.height) || 500);
                populateStatsEditor();
                setupEditableElements();
                saveState();
            }

            window.removeLastStatCard = function() {
                const statsContainer = document.getElementById('quick-stats');
                if (statsContainer.children.length > 1) {
                    statsContainer.lastElementChild.remove();
                    populateStatsEditor();
                    saveState();
                }
            }

            function updateAlignment() {
                const isLogoEnabled = document.getElementById('toggleLogo').checked;
                const header = document.getElementById('company-header');
                const footer = document.getElementById('charts-footer');

                if (isLogoEnabled && logoPosition === 'header') {
                    header.classList.add('layout-side-by-side');
                    header.classList.toggle('layout-logo-right', headerLayout === 'logo-right');
                } else {
                    header.classList.remove('layout-side-by-side', 'layout-logo-right');
                }

                if (isLogoEnabled && logoPosition === 'footer') {
                    footer.classList.add('layout-side-by-side');
                    footer.classList.toggle('layout-logo-right', footerLayout === 'logo-right');
                } else {
                    footer.classList.remove('layout-side-by-side', 'layout-logo-right');
                }
            }


            window.setLogoPosition = function(position, button, doSaveState = true) {
                document.querySelectorAll('[onclick^="setLogoPosition"]').forEach(btn => btn.classList.remove('active'));
                button.classList.add('active');
                logoPosition = position;
                const isChecked = document.getElementById('toggleLogo').checked;
                toggleElement('logo', {checked: isChecked}, false);
                if (doSaveState) saveState();
            }

            window.setHeaderLayout = function(layout, button, doSaveState = true) {
                document.querySelectorAll('[onclick^="setHeaderLayout"]').forEach(btn => btn.classList.remove('active'));
                button.classList.add('active');
                headerLayout = layout;
                updateAlignment();
                if (doSaveState) saveState();
            }
            
            window.setFooterLayout = function(layout, button, doSaveState = true) {
                document.querySelectorAll('[onclick^="setFooterLayout"]').forEach(btn => btn.classList.remove('active'));
                button.classList.add('active');
                footerLayout = layout;
                updateAlignment();
                if (doSaveState) saveState();
            }

            window.selectLogo = function(logoUrl, element) {
                document.getElementById('header-logo').src = logoUrl;
                document.getElementById('footer-logo').src = logoUrl;
                document.querySelectorAll('.logo-choice').forEach(el => el.classList.remove('selected'));
                element.classList.add('selected');
                saveState();
            }

            function updateHeaderAndFooterColors(doSaveState = true) {
                const color = primaryColorPicker.value;
                document.getElementById('company-header').style.backgroundColor = color;
                document.getElementById('charts-footer').style.backgroundColor = color;
                chartData.datasets[0].backgroundColor = [color, `${color}cc`, `${color}99`, `${color}66`, `${color}33`];
                updateStatNumberColor(color, false);
                document.getElementById('statNumberColorPicker').value = color;
                createChart();
                if (doSaveState) saveState();
            }

            window.updateTextColor = function(elementId, color, doSaveState = true) {
                document.getElementById(elementId).style.color = color;
                if (doSaveState) saveState();
            }


            window.updateStatNumberColor = function(color, doSaveState = true) {
                document.querySelectorAll('.stat-number').forEach(el => el.style.color = color);
                if (doSaveState) saveState();
            }

            window.updateStatLabelColor = function(color, doSaveState = true) {
                document.querySelectorAll('.stat-label').forEach(el => el.style.color = color);
                if (doSaveState) saveState();
            }

            window.updateReferenceText = function(text) {
                document.querySelector('#reference-section .editable').textContent = text;
                saveState();
            }

            // --- INICIALIZAÇÃO DA FERRAMENTA ---
            if (typeof loadHTML === 'function') {
                loadHTML('#global-header-container', 'header.html');
            }

            createChart();
            setupEditableElements();
            populateChartDataInputs(); 
            populateStatsEditor();
            updateAlignment();
            document.getElementById('reference-text-input').value = document.querySelector('#reference-section .editable').textContent;


            primaryColorPicker.addEventListener('input', () => {
                document.documentElement.style.setProperty('--primary-color', primaryColorPicker.value);
                updateHeaderAndFooterColors();
            });
            backgroundColorPicker.addEventListener('input', () => {
                document.documentElement.style.setProperty('--background-color', backgroundColorPicker.value);
                saveState();
            });
            
            applyTemplate('classic');
            
            history = [history[history.length - 1]];
            historyIndex = 0;
            updateHistoryButtons();
        }
    </script>
<script type='text/javascript' src='//pl27876671.effectivegatecpm.com/81/6f/74/816f749f9688a0cf1cae1bcf24b9b5e4.js'></script>
<script type='text/javascript' src='//pl27876671.effectivegatecpm.com/81/6f/74/816f749f9688a0cf1cae1bcf24b9b5e4.js'></script>

<script type="text/javascript">
	atOptions = {
		'key' : '1e009bba81deb2bc366b3c4ac030f6be',
		'format' : 'iframe',
		'height' : 90,
		'width' : 728,
		'params' : {}
	};
</script>
<script type="text/javascript" src="//www.highperformanceformat.com/1e009bba81deb2bc366b3c4ac030f6be/invoke.js" defer></script>
<script src="/lang-selector.js" defer></script>
</body>
</html>
